<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ€å¸«ç¶­ä¿®å›å ±ç³»çµ±</title>
    <style>
        /* =========================================
           1. å…¨å±€åŸºç¤è¨­å®š
           ========================================= */
        body { 
            background-color: #efeff4; 
            font-family: -apple-system, "Microsoft JhengHei", "Helvetica Neue", Helvetica, Arial, sans-serif; 
            margin: 0; 
            padding: 20px 0 100px 0; 
            display: flex; 
            justify-content: center; 
            color: #333; 
            line-height: 1.5;
        }

        .form-container { 
            width: 100%; 
            max-width: 640px; 
            margin: 0 12px; 
        }
        /* è®“è¼¸å…¥æ¡†çœ‹èµ·ä¾†æ‰æ‰çš„ï¼Œåƒåº•ç·šæˆ–å°æ–¹æ ¼ */
        /* å®¹å™¨è¨­å®šç‚ºæ›è¡Œæ’åˆ— */
            .fw-container {
                display: flex;
                align-items: center;
                flex-wrap: wrap; /* å…§å®¹éå¯¬æ™‚è‡ªå‹•æŠ˜è¡Œ */
                gap: 5px;
                font-size: 1.1rem;
                padding: 5px 0;
            }

            /* è¼¸å…¥æ¡†ç¾¤çµ„ */
            .fw-inputs {
                display: flex;
                align-items: center;
            }

            /* å–®å€‹å°è¼¸å…¥æ¡†æ¨£å¼ */
            .fw-inputs input {
                width: 35px;
                text-align: center;
                border: none;
                border-bottom: 2px solid #007bff; /* ä½¿ç”¨é¡¯çœ¼çš„åº•ç·š */
                background: transparent;
                padding: 2px 0;
                outline: none;
            }

            .dash {
                margin: 0 2px;
                color: #888;
            }

            .fw-prefix, .fw-suffix {
                font-weight: bold;
                color: #333;
            }
        
        /* =========================================
           2. HEADER å€åŸŸæ¨£å¼
           ========================================= */
        .header-card { 
            background: linear-gradient(135deg, #007377 0%, #005a5e 100%); 
            color: white; 
            padding: 24px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
        }

        .header-main-title { 
            font-size: 24px; 
            font-weight: bold; 
            margin-bottom: 20px; 
            color: #ffeb3b; 
            text-align: center; 
            border-bottom: 1px solid rgba(255,255,255,0.3); 
            padding-bottom: 15px; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .header-section { 
            margin-bottom: 15px; 
            padding: 12px; 
            background: rgba(0, 0, 0, 0.15); 
            border-radius: 6px; 
            font-size: 14px; 
            line-height: 1.6; 
        }

        .header-title-small { 
            font-weight: bold; 
            color: #81d4fa; 
            margin-bottom: 6px; 
            font-size: 16px; 
            display: flex;
            align-items: center;
        }

        .header-title-small::before {
            content: 'ğŸ“Œ';
            margin-right: 6px;
            font-size: 14px;
        }
        
        .header-list {
            margin: 5px 0 0 20px; 
            padding: 0;
            list-style-type: disc;
        }
        
        .header-list li {
            margin-bottom: 4px;
        }

        .header-link { 
            color: #ffeb3b; 
            text-decoration: underline; 
            font-weight: bold; 
            cursor: pointer; 
        }
        
        .header-link:hover {
            color: #fff;
        }
        
        .highlight-text {
            color: #d93025; 
            font-weight: bold;
        }

        .header-footer { 
            font-size: 12px; 
            text-align: center; 
            opacity: 0.8; 
            margin-top: 15px; 
            border-top: 1px dashed rgba(255,255,255,0.2);
            padding-top: 10px;
        }
        .voltage-grid {
        display: grid;
        /* å¹³åˆ†ç‚ºä¸‰æ¬„ */
        grid-template-columns: repeat(3, 1fr); 
        gap: 10px;
        margin-top: 10px;
    }

        .grid-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .grid-item label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .grid-item input {
            width: 100%;
            padding: 8px 5px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px; /* é˜²æ­¢ iOS è‡ªå‹•æ”¾å¤§ */
        }

        /* é»æ“Šè¼¸å…¥æ¡†æ™‚è®Šè‰² */
        .grid-item input:focus {
            border-color: #007bff;
            outline: none;
        }

        /* =========================================
           3. è¡¨å–®é¡Œç›®å¡ç‰‡æ¨£å¼
           ========================================= */
        .question-card { 
            background-color: #fff; 
            padding: 16px 20px; 
            margin-bottom: 12px; 
            border-radius: 8px; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.1); 
            border-left: 4px solid transparent; 
            transition: all 0.2s ease; 
        }

        .question-card:focus-within { 
            border-left-color: #007377; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }

        .question-title { 
            font-size: 16px; 
            font-weight: 600; 
            margin-bottom: 10px; 
            color: #242424; 
            display: flex;
            align-items: center;
        }
        
        /* å¿…å¡«æ˜Ÿè™Ÿæ¨£å¼ */
        .required { 
            color: #d93025; 
            margin-left: 4px; 
            font-weight: bold; 
        }

        /* éŒ¯èª¤ç‹€æ…‹æ¨£å¼ */
        .error-border { 
            border-left-color: #d93025 !important; 
            background-color: #fff0f0;
        }
        
        .error-input { 
            border: 2px solid #d93025 !important; 
            background-color: #fff8f8; 
        }
        
        .hidden-field { 
            display: none !important; 
        } 

        /* =========================================
           4. è¼¸å…¥æ¡†èˆ‡å…ƒä»¶æ¨£å¼
           ========================================= */
        input[type="text"], input[type="date"], input[type="number"], select, textarea { 
            width: 100%; 
            padding: 12px; 
            font-size: 16px; 
            border: 1px solid #dadce0; 
            border-radius: 6px; 
            box-sizing: border-box; 
            background-color: #fafafa; 
            transition: border 0.2s, background 0.2s;
        }

        input:focus, textarea:focus, select:focus { 
            border-color: #007377; 
            background-color: #fff; 
            outline: none; 
            box-shadow: 0 0 0 2px rgba(0, 115, 119, 0.1);
        }
        
        /* Radio Group */
        .radio-group { 
            display: flex; 
            gap: 20px; 
            margin-top: 5px; 
            padding: 5px 0;
        }

        .radio-label { 
            display: flex; 
            align-items: center; 
            cursor: pointer; 
            font-size: 16px; 
            padding: 5px; 
            border-radius: 4px; 
        }
        
        .radio-label:hover { background-color: #f0f0f0; }

        .radio-label input { 
            width: 20px; height: 20px; 
            margin-right: 8px; 
            accent-color: #007377; cursor: pointer; 
        }

        /* Multi-input row */
        .multi-input-row { display: flex; gap: 10px; }
        .multi-input-row input { flex: 1; }

        .small-note { 
            font-size: 13px; color: #666; 
            margin-top: 6px; background-color: #f5f5f5; 
            padding: 4px 8px; border-radius: 4px; 
            display: inline-block; 
        }

        /* =========================================
           5. æº«åº¦æ©«å¼æ’åˆ—
           ========================================= */
        .temp-row {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 12px;
        }
        
        .temp-row:last-child {
            margin-bottom: 0;
        }

        .temp-label {
            font-weight: bold;
            width: 50px;
            flex-shrink: 0;
            text-align: left;
            color: #333;
        }

        .temp-row input {
            width: 100px;
            padding: 8px;
            font-size: 15px;
        }

        .temp-unit {
            color: #666;
            font-size: 14px;
            width: 70px;
            flex-shrink: 0;
        }

        /* =========================================
           6. åº•éƒ¨å›ºå®šæ“ä½œå€
           ========================================= */
        .button-bar { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            background: linear-gradient(to top, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85)); 
            backdrop-filter: blur(5px); 
            padding: 12px 15px; 
            display: flex; 
            gap: 10px; 
            box-shadow: 0 -2px 8px rgba(0,0,0,0.1); 
            z-index: 9999;
        }

        .button-bar button { 
            flex: 1; 
            padding: 14px 10px; 
            font-size: 16px; 
            font-weight: 600; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            transition: all 0.2s; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .button-bar button:active { 
            transform: scale(0.98); 
        }

        .btn-primary { 
            background: linear-gradient(135deg, #007377, #005a5e); 
            color: white; 
        }

        .btn-primary:hover { 
            background: linear-gradient(135deg, #005a5e, #004548); 
        }

        .btn-secondary { 
            background: linear-gradient(135deg, #4CAF50, #45a049); 
            color: white; 
        }

        .btn-secondary:hover { 
            background: linear-gradient(135deg, #45a049, #3d8b40); 
        }

        /* =========================================
           7. RWD æ‰‹æ©Ÿç›´å‘å„ªåŒ–
           ========================================= */
        @media (max-width: 600px) {
            body { padding: 15px 0 100px 0; }
            .form-container { margin: 0 10px; }
            .header-card { padding: 18px; }
            .header-main-title { font-size: 22px; }
            .question-card { padding: 14px 16px; }
            .question-title { font-size: 15px; }
            input, select, textarea { font-size: 16px; padding: 10px; }
            .button-bar { gap: 8px; padding: 10px; }
            .button-bar button { padding: 12px 8px; font-size: 15px; }
            .temp-row input { width: 80px; padding: 6px; font-size: 14px; }
            .temp-label { width: 45px; font-size: 14px; }
            .temp-unit { font-size: 13px; }
        }
    </style>
</head>
<body>

    <div class="form-container">
        <!-- ========== é é¢é ‚éƒ¨èªªæ˜ ========== -->
            <div class="header-card">
                <div class="header-main-title">ğŸ› ï¸ æŠ€å¸«ç¶­ä¿®å›å ±ç³»çµ±</div>
                
    <div class="header-section">
        <div class="header-title-small">ğŸ“¢ å…¬å¸å…§éƒ¨å…¬å‘Š</div>
        
        <div style="color: #e0e0e0; font-size: 0.95em; line-height: 1.8;">
            
            <p style="margin-bottom: 8px;">
                æ­¡è¿ä½¿ç”¨æŠ€å¸«ç¶­ä¿®å›å ±ç³»çµ±ã€‚æœ¬ç³»çµ±ç‚ºå…¬å¸å…§éƒ¨å°ˆç”¨ä½œæ¥­ç³»çµ±ï¼Œ
                åƒ…é™æŠ€å¸«æœ¬äººæ–¼å¯¦éš›åŸ·è¡Œå®‰è£ã€ç¶­ä¿®ã€ä¿é¤Šç­‰å‹¤å‹™æ™‚ä½¿ç”¨ã€‚
            </p>

            <ul style="margin: 0 0 10px 20px; padding-left: 0;">
                <li>
                    <strong style="color: #fff;">è³‡æ–™ä¿å¯†ï¼š</strong>
                    æœ¬ç³»çµ±åŒ…å«å®¢æˆ¶ã€è¨­å‚™åŠä½œæ¥­ç›¸é—œä¹‹æ©Ÿæ•è³‡è¨Šï¼Œ
                    <span style="color: #ffcc00; font-weight: bold;">
                        åš´ç¦ä»¥ä»»ä½•å½¢å¼å…¬é–‹ã€è½‰å‚³ç³»çµ±é€£çµã€æˆªåœ–æˆ–æ´©éœ²ç›¸é—œè³‡æ–™
                    </span>ã€‚
                </li>

                <li>
                    <strong style="color: #fff;">å¡«å¯«è²¬ä»»ï¼š</strong>
                    æ‰€æœ‰å›å ±å…§å®¹å°‡ä½œç‚ºç¶­ä¿®ç´€éŒ„ã€ä¿å›ºåˆ¤å®šã€å®¢è¨´è™•ç†åŠå…§éƒ¨ç¨½æ ¸ä¹‹ä¾æ“šï¼Œ
                    è³‡æ–™ä¸€ç¶“é€å‡ºå³è¦–åŒæœ¬äººå¯¦éš›ä½œæ¥­ç´€éŒ„ï¼Œè«‹å‹™å¿…ç¢ºèªå…§å®¹æ­£ç¢ºã€‚
                </li>

                <li>
                    <strong style="color: #fff;">å¡«å¯«æ™‚æ•ˆï¼š</strong>
                    å›å ±è³‡æ–™è«‹æ–¼å¯¦éš›ä½œæ¥­å®Œæˆå¾Œå³æ™‚å¡«å¯«ï¼Œ
                    ä¸å¾—äº‹å¾Œè£œå¡«ã€ä»£å¡«æˆ–ä½¿ç”¨ä»–äººå¸³è™Ÿå¡«å¯«ã€‚
                </li>

                <li>
                    <strong style="color: #fff;">å¸³è™Ÿä½¿ç”¨ï¼š</strong>
                    æœ¬ç³»çµ±å¸³è™Ÿåƒ…é™æœ¬äººä½¿ç”¨ï¼Œ
                    ç¦æ­¢å€Ÿç”¨ã€å…±ç”¨æˆ–ä»£ä»–äººé€²è¡Œå›å ±ä½œæ¥­ã€‚
                </li>

                <li>
                    <strong style="color: #fff;">ç³»çµ±æ”¯æ´ï¼š</strong>
                    å¦‚é‡ç³»çµ±ç•°å¸¸ã€æ“ä½œå•é¡Œæˆ–éŒ¯èª¤è¨Šæ¯ï¼Œ
                    è«‹å³æ™‚è¯ç¹« <span style="text-decoration: underline;">å“ä¿éƒ¨</span> å”åŠ©è™•ç†ã€‚
                </li>
            </ul>

            <p style="margin-top: 5px; font-size: 0.9em; color: #aaa;">
                âš ï¸ æœ¬ç³»çµ±æ‰€æœ‰æ“ä½œèˆ‡å¡«å¯«ç´€éŒ„çš†ç•™å­˜å‚™æŸ¥ï¼Œ
                é•åä¸Šè¿°è¦ç¯„è€…ï¼Œå°‡ä¾å…¬å¸ç›¸é—œç®¡ç†è¾¦æ³•åŠè³‡è¨Šå®‰å…¨è¦å®šè¾¦ç†ã€‚
            </p>

        </div>
    </div>


            <div class="header-section">
                            <div class="header-title-small">â˜… æœ€æ–°ä½œæ¥­å…¬å‘Š â˜…</div>
                            <p style="margin-bottom: 10px;">ç›®å‰å·²æ­£å¼ä¸Šç·šã€Œæ–°ç‰ˆå„€å™¨ç¶­ä¿®å›å ±ç³»çµ±ã€ï¼Œå³æ—¥èµ·è«‹å…¨é¢æ”¹ç”¨æ–°ç‰ˆç³»çµ±é€²è¡Œå›å ±ã€‚</p>
                            
                            <a href="https://chansonwater0701-cmd.github.io/AssuranceDepartmentOK/test.html" target="_blank" style="display: block; background: rgba(255,255,255,0.2); color: #fff; text-decoration: none; padding: 12px; border-radius: 6px; text-align: center; font-weight: bold; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.3);">
                                ğŸš€ é»æ“Šå‰å¾€æ–°ç‰ˆç³»çµ±
                            </a>

                            <div style="display: flex; gap: 8px; margin-bottom: 15px;">
                                <a href="https://chansonwater0701-cmd.github.io/AssuranceDepartmentOK/%E6%83%9F%E5%93%81%E5%B8%83%E9%81%94%E4%BA%8B%E9%A0%85.pptx" target="_blank" style="flex: 1; background: rgba(0,0,0,0.2); color: #81d4fa; text-decoration: none; padding: 8px; border-radius: 4px; text-align: center; font-size: 13px;">
                                    ğŸ“„ æƒŸå“å¸ƒé” PPT
                                </a>
                                <a href="https://chansonwater0701-cmd.github.io/AssuranceDepartmentOK/åƒå±±å¸ƒé”æ³¨æ„äº‹é ….pptx" target="_blank" style="flex: 1; background: rgba(0,0,0,0.2); color: #81d4fa; text-decoration: none; padding: 8px; border-radius: 4px; text-align: center; font-size: 13px;">
                                    ğŸ“„ åƒå±±å¸ƒé” PPT
                                </a>
                            </div>

                            <div style="border-top: 1px dashed rgba(255,255,255,0.3); margin: 15px 0;"></div>

                            <div class="header-title-small">ğŸ’³ ç¾å ´æœå‹™çµå¸³å°ˆå€</div>
                            <p style="font-size: 13px; opacity: 0.9; margin-bottom: 8px;">CLAR | ç¬å†°ç¬ç†±æ·¨æ°´å™¨ | æŠ€å¸«æœå‹™èˆ‡è€—æä»˜æ¬¾</p>
                            
                            <a href="https://www.myclar.com/Service" target="_blank" style="display: flex; justify-content: space-between; align-items: center; background: #004d40; color: #ffeb3b; text-decoration: none; padding: 10px 15px; border-radius: 6px; font-weight: bold;">
                                <span>å‰å¾€ CLAR å®˜æ–¹æ”¯ä»˜</span>
                                <span>â”</span>
                            </a>
                        </div>

            <div class="header-section">
                <div class="header-title-small">ğŸ“‹ å¡«å¯«é ˆçŸ¥èˆ‡è¦ç¯„</div>
                <ul class="header-list">
                    <li>è«‹ä¾å¯¦éš›ä½œæ¥­æƒ…æ³ç¢ºå¯¦ã€å®Œæ•´å¡«å¯«æœ¬è¡¨å–®å…§å®¹ã€‚</li>
                    <li>å‡¡æ¨™ç¤ºã€Œ <span class="highlight-text">*</span>ã€ä¹‹æ¬„ä½çš†ç‚ºã€å¿…å¡«é …ç›®ã€‘ï¼Œæœªå¡«å¯«å°‡ç„¡æ³•é€å‡ºæˆ–è¦–ç‚ºè³‡æ–™ä¸å®Œæ•´ã€‚</li>
                </ul>
            </div>
            <div class="header-section">
                <ul class="header-list">
                    <li><strong>æ–°æ©Ÿå®‰è£</strong>ï¼šè¨­å‚™è£è¨­ã€æ¸¬è©¦èˆ‡ <u>App ç¶å®š</u></li>
                    <li><strong>æ•…éšœç¶­ä¿®</strong>ï¼šç•°å¸¸æ’é™¤ã€é›¶ä»¶æ›´æ›èˆ‡ <u>ä¿å›ºåˆ¤å®š</u></li>
                    <li><strong>å®šæœŸä¿é¤Š</strong>ï¼šä¾‹è¡Œæª¢æŸ¥ã€<u>å…§éƒ¨æ¸…æ½”</u>èˆ‡æ°´è³ªæª¢æ¸¬</li>
                    <li><strong>è€—ææ›´æ›</strong>ï¼šæ¿¾èŠ¯æ›´æ›èˆ‡ <u>TDS å€¼è¤‡æ¸¬</u></li>
                    <li><strong>ç§»æ©Ÿ / æ’¤æ©Ÿ</strong>ï¼šç•°åœ°è£å¸ä½œæ¥­æˆ–è¨­å‚™æ”¶å›</li>
                    <li><strong>æ“ä½œæ•™å­¸</strong>ï¼šåŸºæœ¬æ“ä½œèªªæ˜ã€App åŠŸèƒ½è¬›è§£</li>
                    <li><strong>ç¾å ´æª¢æ¸¬</strong>ï¼šæ°´å£“ã€æ°´è³ªã€é›»å£“ç­‰æ•¸æ“šé‡æ¸¬</li>
                    <li><strong>é…ä»¶å®‰è£</strong>ï¼šæ”¯æ¶ã€é¾é ­ã€ç®¡ç·šç­‰é…ä»¶åŠ è£æˆ–èª¿æ•´</li>
                    <li><strong>åˆ°å ´æœªæ–½å·¥</strong>ï¼šå·²åˆ°å ´ä½†å› æ¢ä»¶æˆ–å®¢æˆ¶å› ç´ æœªå¯¦éš›ä½œæ¥­</li>
                    <li><strong>éä¿å›ºè™•ç†</strong>ï¼šéä¿æˆ–äººç‚ºå› ç´ ä¹‹ç¶­ä¿®èˆ‡å ±åƒ¹</li>
                    <li><strong>ç•°å¸¸å›å ±</strong>ï¼šç„¡æ³•æ–½å·¥ã€å®¢æˆ¶å–æ¶ˆæˆ–å…¶ä»–ç•°å¸¸ç‹€æ³ç´€éŒ„</li>
                    <li><strong>å¾ŒçºŒè™•ç†</strong>ï¼šéœ€å¦è¡Œæ´¾å·¥ã€å›å» æˆ–ç”³è«‹é›¶ä»¶ä¹‹æ¡ˆä»¶</li>
                </ul>
            </div>
            <div class="header-footer">â€» é™¤éæ‚¨è‡ªè¡Œæä¾›ï¼Œå¦å‰‡ä¸æœƒè‡ªå‹•æ”¶é›†æ‚¨çš„è©³ç´°æ•¸æ“šã€‚</div>
        </div>
    <!-- ========== è¡¨å–®å€åŸŸé–‹å§‹ ========== -->
    <!-- 1. å“ç‰Œé¸æ“‡ -->
    <div class="question-card" id="card-brand">
        <div class="question-title">1. è«‹é¸æ“‡å“ç‰Œ <span class="required">*</span></div>
        <div class="radio-group">
            <label class="radio-label"><input type="radio" name="brand" value="åƒå±±" onclick="handleBrandChange()"> åƒå±±</label>
            <label class="radio-label"><input type="radio" name="brand" value="æƒŸå“" onclick="handleBrandChange()"> æƒŸå“</label>
        </div>
    </div>

    <!-- 2. æœå‹™é …ç›® -->
    <div class="question-card hidden-field" id="card-service-item">
        <div class="question-title"> æœå‹™é …ç›® <span class="required">*</span></div>
        <select name="service_item" id="service_item" onchange="handleServiceItemChange()">
            <option value="">è«‹é¸æ“‡</option>
            <option value="è£æ©Ÿ">è£æ©Ÿ</option>
            <option value="ç¶­ä¿®">ç¶­ä¿®</option>
            <option value="å”®æœ">å”®æœ</option>
            <option value="åˆç´„">åˆç´„</option>
        </select>
    </div>

    <!-- 2-1. æœå‹™ç´°é … (æ ¹æ“šå“ç‰Œèˆ‡æœå‹™é …ç›®å‹•æ…‹è®ŠåŒ–) -->
    <div class="question-card hidden-field" id="card-service-detail">
        <div class="question-title">æœå‹™ç´°é … <span class="required">*</span></div>
        <select name="service_detail" id="service_detail" onchange="handleServiceDetailChange()">
            <option value="">è«‹é¸æ“‡</option>
        </select>
    </div>

    <!-- 2-2. æ‰‹å‹•è¼¸å…¥æœå‹™ç´°é … (ç•¶é¸æ“‡"å…¶ä»–"æ™‚é¡¯ç¤º) -->
    <div class="question-card hidden-field" id="card-manual-input">
        <div class="question-title">è«‹è¼¸å…¥æœå‹™ç´°é …</div>
        <input type="text" name="manual_service_detail" placeholder="è«‹è¼¸å…¥è©³ç´°æœå‹™å…§å®¹">
    </div>

    <!-- 3. æ©Ÿå™¨å‹è™Ÿ -->
    <div class="question-card hidden-field" id="card-model">
        <div class="question-title">æ©Ÿå™¨å‹å¼ <span class="required">*</span></div>
        <select name="machine_type" id="model" inputmode="url" onchange="handleModelChange()">
            <option value="">è«‹é¸æ“‡</option>
        </select>
    </div>
    <!-- ========== ä»¥ä¸‹æ˜¯åƒå±±çš„æ¬„ä½ (ä¿æŒåŸæ¨£) ========== -->
    <!-- æŠ€å¸«å§“å -->
    <div class="question-card hidden-field" id="card-name">
        <div class="question-title">æŠ€å¸«å§“å <span class="required">*</span></div>
        <input type="text" name="engineer_name" placeholder="è«‹è¼¸å…¥æŠ€å¸«å§“å">
    </div>

    <!-- å®¢æˆ¶å§“å -->
    <div class="question-card hidden-field" id="card-wp-customer">
        <div class="question-title">å®¢æˆ¶å§“å <span class="required">*</span></div>
        <input type="text" name="wp_customer_name" placeholder="è«‹è¼¸å…¥å®¢æˆ¶å§“å">
    </div>
    <!-- å®¢æˆ¶ä»£è™Ÿ -->

    <div class="question-card hidden-field" id="card-customer-code">
        <div class="question-title">å®¢æˆ¶ä»£è™Ÿ<span class="required">*</span></div>
        <input 
            type="text" 
            name="customer_code" 
            id="customer_code_input"
            placeholder="è«‹è¼¸å…¥å®¢æˆ¶ä»£è™Ÿ" 
            onblur="formatCustomerCode(this)"
        >
        <div class="small-note" style="margin-top: 8px; color: #666; font-size: 0.9rem;">
            ğŸ’¡ è¼¸å…¥æé†’ï¼š æƒŸå“è«‹è¼¸å…¥æ•¸å­—ï¼ˆç³»çµ±å°‡è‡ªå‹•è£œå…¨ç‚º W é–‹é ­ 10 ç¢¼ï¼‰ï¼›åƒå±±è«‹ä¾åŸä»£è™Ÿè¼¸å…¥å³å¯ã€‚<br>
            (ä¾‹ï¼šè¼¸å…¥ 1234 â” W000001234)
        </div>
    </div>

    <!-- å®¢æˆ¶åœ°å€ -->
    <div class="question-card hidden-field" id="card-address">
        <div class="question-title">å®¢æˆ¶åœ°å€<span class="required">*</span></div>
        <input type="text" name="customer_address" placeholder="è«‹è¼¸å…¥å®¢æˆ¶åœ°å€">
    </div>

    <!-- å®¢æˆ¶é›»è©± -->
    <div class="question-card hidden-field" id="card-phone">
        <div class="question-title">å®¢æˆ¶é›»è©± <span class="required">*</span></div>
        <input type="text" name="customer_phone" placeholder="è«‹è¼¸å…¥å®¢æˆ¶é›»è©±">
    </div>



    <!-- ========== æ–°å¢ç¶­ä¿®ç›¸é—œæ¬„ä½ ========== -->
    <!-- æœå‹™æ—¥æœŸ -->
    <div class="question-card hidden-field" id="card-service-date">
        <div class="question-title">æœå‹™æ—¥æœŸ<span class="required">*</span></div>
        <input 
            type="text" 
            name="service_date" 
            placeholder="å¹´/æœˆ/æ—¥" 
            onfocus="(this.type='date')" 
            onblur="if(!this.value)this.type='text'"
        >
    </div>
    <!-- éŠ·è²¨å–®è™Ÿ -->
    <div class="question-card hidden-field" id="card-invoice-number">
        <div class="question-title">éŠ·è²¨å–®è™Ÿ<span class="required">*</span></div>
        <input type="number" name="invoice_number" placeholder="è«‹è¼¸å…¥éŠ·è²¨å–®è™Ÿ">
    </div>
    <!-- æ©Ÿå™¨å‹è™Ÿ -->
    <div class="question-card hidden-field" id="card-machine-type">
        <div class="question-title">æ©Ÿå™¨å‹è™Ÿ<span class="required">*</span></div>
        <input type="text" name="machine_model" placeholder="è«‹è¼¸å…¥æ©Ÿå™¨å‹è™Ÿ">
    </div>
    <!-- æ©Ÿå™¨åºè™Ÿ -->
    <div class="question-card hidden-field" id="card-machine-serial">
        <div class="question-title">æ©Ÿå™¨åºè™Ÿ<span class="required">*</span></div>
        <input type="number" name="machine_serial" placeholder="è«‹è¼¸å…¥æ©Ÿå™¨åºè™Ÿ">
    </div>
    <!-- æ©Ÿå™¨ç‰ˆæœ¬ -->
    <div class="question-card hidden-field" id="card-machine-model">
        <div class="question-title">æ©Ÿå™¨ç‰ˆæœ¬<span class="required">*</span></div>
        <input type="text" name="machine_version" placeholder="è«‹è¼¸å…¥æ©Ÿå™¨ç‰ˆæœ¬">
    </div>
    
    <!-- å®‰è£ä½ç½® -->
    <div class="question-card hidden-field" id="card-install-location">
        <div class="question-title">å®‰è£ä½ç½®<span class="required">*</span></div>
        <input type="text" name="install_location" placeholder="è«‹è¼¸å…¥å®‰è£ä½ç½®">
    </div>


    <!-- å®‰è£æ¨“å±¤< -->
    <div class="question-card hidden-field" id="card-install-floor">
        <div class="question-title">æ¨“å±¤è³‡è¨Š<span class="required">*</span></div>
        <div class="multi-input-row">
            <input type="text" name="install_floor" placeholder="å®‰è£æ¨“å±¤ (ä¾‹: 3F)">
            <input type="text" name="total_floors" placeholder="ç¸½æ¨“å±¤æ•¸ (ä¾‹: 12F)">
        </div>
    </div>
    <div class="question-card hidden-field" id="card-machine-type-2">
        <div class="question-title">æ©Ÿå™¨å‹è™Ÿ(ç¬¬äºŒå°)<span class="required">*</span></div>
        <input type="text" name="machine_type_2" placeholder="è«‹è¼¸å…¥ç¬¬äºŒå°æ©Ÿå™¨å‹è™Ÿ">
    </div>

    <div class="question-card hidden-field" id="card-machine-serial-2">
        <div class="question-title">æ©Ÿå™¨åºè™Ÿ(ç¬¬äºŒå°)<span class="required">*</span></div>
        <input type="text" name="machine_serial_2" placeholder="è«‹è¼¸å…¥ç¬¬äºŒå°æ©Ÿå™¨åºè™Ÿ">
    </div>


    <div class="question-card hidden-field" id="card-machine-model-2">
        <div class="question-title">æ©Ÿå™¨ç‰ˆæœ¬(ç¬¬äºŒå°)<span class="required">*</span></div>
        <input type="text" name="machine_style_2" placeholder="è«‹è¼¸å…¥ç¬¬äºŒå°æ©Ÿå™¨å‹å¼">
    </div>


    <!-- æ”¶æ¬¾é‡‘é¡ -->
    <div class="question-card hidden-field" id="card-payment">
        <div class="question-title">æ”¶æ¬¾é‡‘é¡<span class="required">*</span></div>
        <input type="number" name="payment_amount" placeholder="è«‹è¼¸å…¥é‡‘é¡">
    </div>

    <!-- ä»˜æ¬¾æ–¹å¼ -->
    <div class="question-card hidden-field" id="card-payment-method">
        <div class="question-title">ä»˜æ¬¾æ–¹å¼<span class="required">*</span></div>
        <select name="payment_method">
            <option value="">è«‹é¸æ“‡</option>
            <option value="ç¾é‡‘">ç¾é‡‘</option>
            <option value="åˆ·å¡">åˆ·å¡</option>
            <option value="è½‰å¸³">è½‰å¸³</option>
            <option value="LINE PAY">LINE PAY</option>
        </select>
    </div>
    <!-- åŸæ°´TDS -->
    <div class="question-card hidden-field" id="card-raw-tds">
        <div class="question-title">åŸæ°´TDS<span class="required">*</span></div>
        <input type="number" name="raw_tds" placeholder="è«‹è¼¸å…¥åŸæ°´TDS">
    </div>
    <!-- åŸå§‹æ°´å£“ (ç”¨æ–¼ä¸€èˆ¬è£æ©Ÿï¼ŒåŒ…å«æ¸›å£“é–¥é¸é …) -->
    <div class="question-card hidden-field" id="card-original-pressure">
        <div class="question-title">åŸå§‹æ°´å£“<span class="required">*</span></div>
        <input type="number" name="original_pressure" placeholder="åŸå§‹æ°´å£“å€¼">
        <div class="question-title" style="margin-top: 15px;">æ¸›å£“é–¥</div>
            <select name="pressure_valve" id="pressure_valve" onchange="handlePressureValveChange()">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>
    <!-- æ¸›å£“æ°´å£“ (ç•¶æ¸›å£“é–¥é¸æ“‡"æœ‰"æ™‚é¡¯ç¤º) -->
    <div class="question-card hidden-field" id="card-reduced-pressure">
        <div class="question-title">æ¸›å£“æ°´å£“<span class="required">*</span></div>
        <input type="text" name="reduced_pressure" placeholder="æ¸›å£“å¾Œæ°´å£“å€¼">
    </div>

    <!-- å ´åœ°é›»å£“ -->
    <div class="question-card hidden-field" id="card-site-voltage">
        <div class="question-title">å ´åœ°é›»å£“<span class="required">*</span></div>
        <input type="number" name="water_install_location" placeholder="è«‹è¼¸å…¥å ´åœ°é›»å£“">
    </div>

    <!-- åŠ å£“é¦¬é” -->
    <div class="question-card hidden-field" id="card-pressure-pump">
        <div class="question-title">åŠ å£“é¦¬é”<span class="required">*</span></div>
        <select name="pressure_pump" id="pressure_pump">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>
    <!-- æ¼æ°´æ–·è·¯å™¨ -->
    <div class="question-card hidden-field" id="card-leak-circuit">
        <div class="question-title">æ¼æ°´æ–·è·¯å™¨<span class="required">*</span></div>
        <select name="leak_circuit" id="leak_circuit" onchange="handleLeakCircuitChange()">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰å®‰è£">æœ‰å®‰è£</option>
            <option value="æœªå®‰è£">æœªå®‰è£</option>
        </select>
    </div>
    <div class="question-card hidden-field" id="card-drainage-type">
        <div class="question-title">æ’å»¢æ°´å‹å¼<span class="required">*</span></div>
        <select name="drainage_type">
            <option value="ï¼´å­—ï¼“é€š">ï¼´å­—ï¼“é€š</option>
            <option value="ç ´ç®¡">ç ´ç®¡</option>
            <option value="åœ°æ’">åœ°æ’</option>
        </select>
    </div>


    <div class="question-card hidden-field" id="card-countertop">
        <div class="question-title">æµç†å°é¢<span class="required">*</span></div>
        <input type="text" name="countertop" placeholder="è«‹è¼¸å…¥æµç†å°é¢èªªæ˜åŸå› ">
    </div>


    <!-- é¾é ­å‹å¼ -->
    <div class="question-card hidden-field" id="card-faucet-type">
        <div class="question-title">é¾é ­å‹å¼<span class="required">*</span></div>
        <select name="faucet_type">
            <option value="">è«‹é¸æ“‡</option>
            <option value="ç¶“å…¸-åŸºæœ¬æ¬¾">ç¶“å…¸-åŸºæœ¬æ¬¾</option>
            <option value="ç¶“å…¸-çŸ³å¢¨é»‘">ç¶“å…¸-çŸ³å¢¨é»‘</option>
            <option value="ç¶“å…¸-ç«ç‘°é‡‘">ç¶“å…¸-ç«ç‘°é‡‘</option>
            <option value="æ™ºæ…§-å¤ªç©ºéŠ€">æ™ºæ…§-å¤ªç©ºéŠ€</option>
            <option value="æ™ºæ…§-æ›œçŸ³é»‘">æ™ºæ…§-æ›œçŸ³é»‘</option>
            <option value="æ™ºæ…§-æµ®å…‰é‡‘">æ™ºæ…§-æµ®å…‰é‡‘</option>
            <option value="æ™ºæ…§-æœˆå½±ç°">æ™ºæ…§-æœˆå½±ç°</option>
        </select>
    </div>
    <!-- é¾é ­æ¨™ç±¤ -->
    <div class="question-card hidden-field" id="card-faucet-label">
        <div class="question-title">é¾é ­æ¨™ç±¤<span class="required">*</span></div>
        <input type="text" name="faucet_label" placeholder="è«‹è¼¸å…¥é¾é ­æ¨™ç±¤">
    </div>


    <!-- æ¸›å£“æ°´å£“ (å­é …ç›®) -->
    <div class="question-card hidden-field" id="card-reduced-pressure">
        <div class="question-title">æ¸›å£“æ°´å£“<span class="required">*</span></div>
        <input type="text" name="reduced_pressure" placeholder="è«‹è¼¸å…¥æ¸›å£“å¾Œçš„æ°´å£“">
    </div>


    <!-- ========== ä»¥ä¸‹æ˜¯æƒŸå“çš„å°ˆå±¬æ¬„ä½ ========== -->



    <!-- éŸŒé«”ç‰ˆæœ¬ -->
    <div class="question-card hidden-field" id="card-firmware-version">
        <div class="question-title">éŸŒé«”ç‰ˆæœ¬<span class="required">*</span></div>
        <div class="fw-container">
            <div class="fw-inputs">
                <input type="number" name="firmware_1" maxlength="2" placeholder="00">
                <span class="dash">-</span>
                <input type="number" name="firmware_2" maxlength="2" placeholder="00">
                <span class="dash">-</span>
                <input type="number" name="firmware_3" maxlength="2" placeholder="00">
                <span class="dash">-</span>
                <input type="number" name="firmware_4" maxlength="2" placeholder="00">
            </div>
        </div>
    </div>
        <!-- é¢æ¿ç‰ˆæœ¬ -->
    <div class="question-card hidden-field" id="card-panel-version">
        <div class="question-title">é¢æ¿ç‰ˆæœ¬<span class="required">*</span></div>
        <div class="fw-container">
            <div class="fw-inputs">
                <input type="text" name="panel_version" maxlength="15" placeholder="å¡«å¯«é¢æ¿ç‰ˆæœ¬">
            </div>
        </div>
    </div>
        <div class="question-card hidden-field" id="card-panel-voltage">
        <div class="question-title">é¢æ¿é›»å£“ (V)<span class="required">*</span></div>
        
        <div class="voltage-grid">
            <div class="grid-item">
                <label>é¢æ¿ä¼‘çœ </label>
                <input type="number" name="voltage_sleep" step="0.01" placeholder="0.01">
            </div>
            
            <div class="grid-item">
                <label>å–šé†’</label>
                <input type="number" name="voltage_wake" step="1" placeholder="158">
            </div>
            
            <div class="grid-item">
                <label>å……é›»é›»å£“(mV)</label>
                <input type="number" name="voltage_charge" step="0.001" placeholder="0.502">
            </div>
        </div>
    </div>


    <!-- ç’°å¢ƒæº«åº¦ -->
    <div class="question-card hidden-field" id="card-env-temp">
        <div class="question-title">ç’°å¢ƒæº«åº¦<span class="required">*</span></div>
        <input type="number" name="env_temp" placeholder="è«‹è¼¸å…¥ç’°å¢ƒæº«åº¦">
    </div>

    <!-- æº«åº¦èˆ‡æ°´é‡çµ„åˆ (ç”¨æ–¼WS2-Cå’ŒWD2-C) -->
    <div class="question-card hidden-field" id="card-temp-group">
        <div class="question-title">æº«åº¦èˆ‡æ°´é‡ <span class="required">*</span></div>
        
        <div class="temp-row" id="temp-100">
            <span class="temp-label">100Â°C</span>
            <input type="number" name="temp_100" placeholder="æº«åº¦">
            <span class="temp-unit">â„ƒ</span>
            <input type="number" name="flow_100" placeholder="æ°´é‡">
            <span class="temp-unit">ml/min</span>
        </div>
        
        <div class="temp-row" id="temp-35">
            <span class="temp-label">35Â°C</span>
            <input type="number" name="temp_35" placeholder="æº«åº¦">
            <span class="temp-unit">â„ƒ</span>
            <input type="number" name="flow_35" placeholder="æ°´é‡">
            <span class="temp-unit">ml/min</span>
        </div>
        
        <div class="temp-row" id="temp-10">
            <span class="temp-label">10Â°C</span>
            <input type="number" name="temp_10" placeholder="æº«åº¦">
            <span class="temp-unit">â„ƒ</span>
            <input type="number" name="flow_10" placeholder="æ°´é‡">
            <span class="temp-unit">ml/min</span>
        </div>
    </div>

        <!-- æº«åº¦èˆ‡æ°´é‡çµ„åˆ (ç”¨æ–¼WS2-Cå’ŒWD2-C) -->
    <div class="question-card hidden-field" id="card-temp-group-100">
        <div class="question-title">æº«åº¦èˆ‡æ°´é‡ <span class="required">*</span></div>
        
        <div class="temp-row" id="temp-100">
            <span class="temp-label">100Â°C</span>
            <input type="number" name="temp_100" placeholder="æº«åº¦">
            <span class="temp-unit">â„ƒ</span>
        </div>
        
        <div class="temp-row" id="temp-35">
            <span class="temp-label">35Â°C</span>
            <input type="number" name="temp_35" placeholder="æº«åº¦">
            <span class="temp-unit">â„ƒ</span>
        </div>

    </div>

    <!-- èª¿æ•´åŠŸç‡ -->
    <div class="question-card hidden-field" id="card-adjust-power">
        <div class="question-title">èª¿æ•´åŠŸç‡<span class="required">*</span></div>
        <input type="number" name="adjust_power" placeholder="è«‹è¼¸å…¥èª¿æ•´åŠŸç‡">
    </div>

    <!-- åŠŸç‡çµ„åˆ (ç†±æ°´èˆ‡å†°æ°´æœ€å¤§åŠŸç‡) -->
    <div class="question-card hidden-field" id="card-power">
        <div class="question-title">æœ€å¤§åŠŸç‡ <span class="required">*</span></div>
        <div class="multi-input-row">
            <input type="number" name="hot_max_power" placeholder="ç†±æ°´æœ€å¤§åŠŸç‡">
            <input type="number" name="cold_max_power" placeholder="å†°æ°´æœ€å¤§åŠŸç‡">
        </div>
    </div>

    <div class="question-card hidden-field" id="card-power-hot">
        <div class="question-title">æœ€å¤§åŠŸç‡ <span class="required">*</span></div>
        <input type="number" name="hot_max_power" placeholder="ç†±æ°´æœ€å¤§åŠŸç‡">
    </div>

    <!-- åŸæ°´æ°´é‡ -->
    <div class="question-card hidden-field" id="card-raw-flow">
        <div class="question-title">åŸæ°´æ°´é‡<span class="required">*</span></div>
        <input type="number" name="raw_flow" placeholder="è«‹è¼¸å…¥åŸæ°´æ°´é‡">
    </div>

    <!-- åŸæ°´æº«åº¦ -->
    <div class="question-card hidden-field" id="card-raw-temp">
        <div class="question-title">åŸæ°´æº«åº¦<span class="required">*</span></div>
            <div class="fw-inputs">
                <input type="number" name="fw_1" maxlength="5" placeholder="0åˆ†é˜ â„ƒ">

                <input type="number" name="fw_2" maxlength="5" placeholder="1åˆ†é˜ â„ƒ">

                <input type="number" name="fw_3" maxlength="5" placeholder="2åˆ†é˜ â„ƒ">

                <input type="number" name="fw_4" maxlength="5" placeholder="3åˆ†é˜ â„ƒ">
            </div>
    </div>
    <!-- æº«åº¦åŸç†åŠå……é›»æ–¹æ³•å®¢æˆ¶æ˜¯å¦æ¥å—ç†è§£ -->
    <div class="question-card hidden-field" id="card-principle">
        <div class="question-title">æº«åº¦åŸç†åŠå……é›»æ–¹æ³•å®¢æˆ¶æ˜¯å¦æ¥å—ç†è§£<span class="required">*</span></div>
        <select name="principle_explained" id="principle_explained" onchange="handlePrincipleChange()">
            <option value="">è«‹é¸æ“‡</option>
            <option value="æ˜¯">æ˜¯</option>
            <option value="å¦">å¦</option>
        </select>
    </div>

    <div class="question-card hidden-field" id="card-principle-reason">
        <div class="question-title">æœªå‘å®¢æˆ¶èªªæ˜åŸå› <span class="required">*</span></div>
        <textarea name="principle_reason" rows="2" placeholder="è«‹æè¿°æœªå‘å®¢æˆ¶èªªæ˜åŸå› "></textarea>
    </div>

    <!-- å£æ„Ÿçµ„åˆ (æŠ€å¸«èˆ‡å®¢æˆ¶) -->
    <div class="question-card hidden-field" id="card-taste">
        <div class="question-title">æŠ€å¸«/å®¢æˆ¶å£æ„Ÿè©•åƒ¹ <span class="required">*</span></div>
        <div class="multi-input-row">
            <input type="text" name="engineer_taste" placeholder="æŠ€å¸«å£æ„Ÿ">
            <input type="text" name="customer_taste" placeholder="å®¢æˆ¶å£æ„Ÿ">
        </div>
    </div>

    <!-- æ°´é‡æ ¡æ­£æ–¹å¼ -->
    <div class="question-card hidden-field" id="card-calibration">
        <div class="question-title">æ°´é‡æ ¡æ­£æ–¹å¼<span class="required">*</span></div>
        <input type="text" name="calibration" placeholder="è«‹è¼¸å…¥æ°´é‡æ ¡æ­£æ–¹å¼">
    </div>

    <!-- é›»æ± æ¬¾å¼ -->
    <div class="question-card hidden-field" id="card-battery">
        <div class="question-title">é›»æ± æ¬¾å¼<span class="required">*</span></div>
        <input type="text" name="battery" placeholder="è«‹è¼¸å…¥é›»æ± æ¬¾å¼">
    </div>

    <!-- æ˜¯å¦åŠ è£Filter-C -->
    <div class="question-card hidden-field" id="card-æ˜¯å¦åŠ è£Filter-C">
        <div class="question-title">æ˜¯å¦åŠ è£Filter-C<span class="required">*</span></div>
        <select name="add_filter_c" id="add_filter_c">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æ˜¯">æ˜¯</option>
            <option value="å¦">å¦</option>
        </select>
    </div>
    <!-- F11å…¥æ°´æ°´é‡ (WD1å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-f11-flow">
        <div class="question-title">F11å…¥æ°´æ°´é‡<span class="required">*</span></div>
        <input type="text" name="f11_flow" placeholder="è«‹è¼¸å…¥F11å…¥æ°´æ°´é‡">
    </div>

    <!-- ç†±ç¼¸å‡ºæ°´ (WD1å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-hot-tank-output">
        <div class="question-title">ç†±ç¼¸å‡ºæ°´<span class="required">*</span></div>
        <input type="text" name="hot_tank_output" placeholder="è«‹è¼¸å…¥ç†±ç¼¸å‡ºæ°´">
    </div>

    <!-- å¸¸æº«ç¼¸å‡ºæ°´ (WD1å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-normal-tank-output">
        <div class="question-title">å¸¸æº«ç¼¸å‡ºæ°´<span class="required">*</span></div>
        <input type="text" name="normal_tank_output" placeholder="è«‹è¼¸å…¥å¸¸æº«ç¼¸å‡ºæ°´">
    </div>

    <!-- å†°ç¼¸å‡ºæ°´ (WD1å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-ice-tank-output">
        <div class="question-title">å†°ç¼¸å‡ºæ°´<span class="required">*</span></div>
        <input type="text" name="ice_tank_output" placeholder="è«‹è¼¸å…¥å†°ç¼¸å‡ºæ°´">
    </div>

    <!-- å†°ç¼¸é™æº« (WD1å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-ice-tank-cooling">
        <div class="question-title">å†°ç¼¸é™æº«<span class="required">*</span></div>
        <select name="principle_explained" id="principle_explained" onchange="handlePrincipleChange()">
            <option value="" disabled selected>è«‹é¸æ“‡ç‹€æ…‹</option>
            <option value="yes">æ˜¯</option>
            <option value="no">å¦</option>
        </select>
    </div>

    <!-- å ±ä¿®åŸå›  (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-repair-reason">
        <div class="question-title">å ±ä¿®åŸå› <span class="required">*</span></div>
        <textarea name="repair_reason" rows="3" placeholder="è«‹è¼¸å…¥å ±ä¿®åŸå› "></textarea>
    </div>

    <!-- å¯¦éš›åŸå›  (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-actual-reason">
        <div class="question-title">å¯¦éš›åŸå› <span class="required">*</span></div>
        <textarea name="actual_reason" rows="3" placeholder="è«‹è¼¸å…¥å¯¦éš›åŸå› "></textarea>
    </div>

    <!-- è™•ç†æ–¹å¼ (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-handling">
        <div class="question-title">è™•ç†æ–¹å¼<span class="required">*</span></div>
        <textarea name="handling" rows="3" placeholder="è«‹è¼¸å…¥è™•ç†æ–¹å¼"></textarea>
    </div>

    <!-- æª¢ä¿®çµæœ (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-inspection-result">
        <div class="question-title">æª¢ä¿®çµæœ<span class="required">*</span></div>
        <textarea name="inspection_result" rows="3" placeholder="è«‹è¼¸å…¥æª¢ä¿®çµæœ"></textarea>
    </div>

    <!-- æ›´æ›é›¶ä»¶ (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-replaced-parts">
        <div class="question-title">æ›´æ›é›¶ä»¶<span class="required">*</span></div>
        <input type="text" name="wp_replaced_parts" placeholder="è«‹è¼¸å…¥æ›´æ›çš„é›¶ä»¶">
    </div>

    <!-- æ–™ä»¶æ”¶æ¬¾ (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-parts-payment">
        <div class="question-title">æ–™ä»¶æ”¶æ¬¾<span class="required">*</span></div>
        <input type="number" name="parts_payment" placeholder="è«‹è¼¸å…¥æ–™ä»¶æ”¶æ¬¾é‡‘é¡">
    </div>
    <div class="question-card hidden-field" id="card-is-payment">
        <div class="question-title">æ˜¯å¦æ”¶æ¬¾ <span class="required">*</span></div>
        <select name="is_payment" id="is_payment" onchange="handlePaymentVisibility()">
            <option value="">è«‹é¸æ“‡</option>
            <option value="æ˜¯">æ˜¯</option>
            <option value="å¦">å¦</option>
        </select>
    </div>
        
    <!-- æ”¶æ¬¾å“é … (ç¶­ä¿®å°ˆç”¨) -->
<div class="question-card hidden-field" id="card-water-source">
        <div class="question-title">æ°´æºä½ç½®ç…§<span class="required">*</span></div>
        <select name="water_source_photo" id="water_source_photo">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>

    <div class="question-card hidden-field" id="card-pipe-spec">
        <div class="question-title">æ°´ç®¡è¦æ ¼ç…§<span class="required">*</span></div>
        <select name="pipe_spec_photo" id="pipe_spec_photo">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>

    <div class="question-card hidden-field" id="card-pump-photo">
        <div class="question-title">å…¨æ™¯ç…§/è¿‘ç…§<span class="required">*</span></div>
        <select name="pump_photo" id="pump_photo">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>

    <div class="question-card hidden-field" id="card-pipe-material">
        <div class="question-title">ç®¡ç·šæè³ª<span class="required">*</span></div>
        <select name="pipe_material" id="pipe_material">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>

    <div class="question-card hidden-field" id="card-signal-strength">
        <div class="question-title">è¨Šè™Ÿå¼·åº¦<span class="required">*</span></div>
        <select name="signal_strength" id="signal_strength">
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>



    <!-- æ”¶æ¬¾å“é … (ç¶­ä¿®å°ˆç”¨) -->
    <div class="question-card hidden-field" id="card-payment-detail">
        <div class="question-title">æ”¶æ¬¾å“é …<span class="required">*</span></div>
        <textarea name="payment_detail" rows="3" placeholder="è«‹è¼¸å…¥æ”¶æ¬¾å“é …"></textarea>
    </div>
    <!-- æ˜¯å¦å·²ç¶å®šApp -->
    <div class="question-card hidden-field" id="card-app">
        <div class="question-title">æ˜¯å¦å·²ç¶å®šApp<span class="required">*</span></div>
        <select name="app_binding" id="app_binding" required>
            <option value="" disabled selected>è«‹é¸æ“‡...</option>
            <option value="æœ‰">æœ‰</option>
            <option value="ç„¡">ç„¡</option>
        </select>
    </div>
    <!-- å…¶ä»–èªªæ˜äº‹é … (æƒŸå“) -->
    <div class="question-card hidden-field" id="card-wp-note">
        <div class="question-title">å…¶ä»–èªªæ˜äº‹é … </div>
        <textarea name="wp_other_notes" rows="3" placeholder="è«‹è¼¸å…¥å…¶ä»–éœ€è¦èªªæ˜çš„äº‹é …"></textarea>
    </div>

    <!-- ========== åº•éƒ¨æ“ä½œæŒ‰éˆ• ========== -->
    <div class="button-bar">
        <button class="btn-primary" onclick="copyForLine()">ğŸ“‹ è¤‡è£½LINEæ ¼å¼</button>
        <button class="btn-secondary" id="btn-upload" onclick="uploadToCloud()">â˜ï¸ ä¸Šå‚³è³‡æ–™</button>
    </div>
</div>

<script>
    const CLOUD_URL = "https://script.google.com/macros/s/AKfycbz2F7RDc9ktIf5TjqAqJ-CT7Ue_tG3uHSUuCJrLRbDT0GIuEj77gcingkqkaJUyTqiBUQ/exec";
    let currentBrand = '';
    let currentServiceItem = '';
    let currentServiceDetail = '';
    let currentModel = '';
    let currentRequiredIds = [];

    // åƒå±±è£æ©Ÿå¿…å¡«æ¬„ä½ID
    const qsInstallRequired = [
    'card-name', 'card-service-date', 'card-customer',
    'card-original-pressure', 'card-site-voltage', 'card-drainage-type', // æ”¹æ­£äº†
    'card-raw-pressure', 'card-raw-tds', 
    ];

    // åƒå±±ä¸€èˆ¬ç¶­ä¿®å¿…å¡«æ¬„ä½ID
    const qsRepairRequired = [
        'card-name', 'card-service-date', 'card-customer',
        'card-replaced-parts'
    ];

    // å“ç‰Œé¸æ“‡è™•ç†
    function handleBrandChange() {
        const brandRadio = document.querySelector('input[name="brand"]:checked');
        if (!brandRadio) return;
        const brand = brandRadio.value;

        // 1. ç¢ºèªæ˜¯å¦åˆ‡æ›å“ç‰Œ
        if (currentBrand && currentBrand !== brand) {
            if (!confirm("è®Šæ›´å“ç‰Œå°‡æœƒæ¸…é™¤ç›®å‰æ‰€æœ‰å·²å¡«å¯«çš„å…§å®¹ï¼Œç¢ºå®šè¦è®Šæ›´å—ï¼Ÿ")) {
                const radios = document.querySelectorAll('input[name="brand"]');
                radios.forEach(r => { r.checked = (r.value === currentBrand); });
                return;
            }
        }

        // 2. æ›´æ–°å“ç‰Œç‹€æ…‹èˆ‡é‡ç½®
        currentBrand = brand;
        resetFormValues(['brand']); // ä¿ç•™å“ç‰Œå‹¾é¸ï¼Œå…¶é¤˜æ¸…é™¤
        
        currentServiceItem = '';
        currentServiceDetail = '';
        currentModel = '';
        hideAllCards();

        // â˜…â˜…â˜… 3. è™•ç†å®¢æˆ¶ä»£è™Ÿæ¬„ä½ (é‡é»ä¿®æ”¹å€) â˜…â˜…â˜…
        const codeInput = document.getElementById('customer_code_input');
        if (codeInput) {
            if (currentBrand === 'åƒå±±') {
                // åƒå±±è¨­å®šï¼š
                // 1. å…è¨±æ–‡å­—è¼¸å…¥ (text) ä»¥ä¾¿è¼¸å…¥ A
                // 2. å€¼æ˜¯ç©ºçš„ï¼Œè®“æŠ€å¸«è‡ªå·±å¡«
                codeInput.setAttribute('inputmode', 'text');
                codeInput.value = ""; 
                codeInput.placeholder = "è«‹è¼¸å…¥å®Œæ•´ä»£è™Ÿ (ä¾‹: A123456789)";
            } else if (currentBrand === 'æƒŸå“') {
                // æƒŸå“è¨­å®šï¼š
                // 1. é è¨­å¡«å¥½ "W0000" (å¯«æ­»é–‹é ­)
                // 2. ç”¨æ•¸å­—éµç›¤ (numeric) æ–¹ä¾¿æ‰“å¾Œé¢çš„æ•¸å­—
                codeInput.setAttribute('inputmode', 'numeric');
                codeInput.value = "W0000"; 
                codeInput.placeholder = "è«‹è¼¸å…¥æ•¸å­—";
            }
        }
        // â˜…â˜…â˜… ä¿®æ”¹çµæŸ â˜…â˜…â˜…

        // 4. é‡å»ºæœå‹™é …ç›®é¸å–® (é€™éƒ¨åˆ†ä¿æŒåŸæœ¬é‚è¼¯)
        const serviceSelect = document.getElementById('service_item');
        serviceSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';

        if (currentBrand === 'åƒå±±') {
            serviceSelect.innerHTML += `
                <option value="è£æ©Ÿ">è£æ©Ÿ</option>
                <option value="ç¶­ä¿®">ç¶­ä¿®</option>
                <option value="å”®æœ">å”®æœ</option>
                <option value="åˆç´„">åˆç´„</option>`;
        } else if (currentBrand === 'æƒŸå“') {
            serviceSelect.innerHTML += `
                <option value="è£æ©Ÿ">è£æ©Ÿ</option>
                <option value="ç¶­ä¿®">ç¶­ä¿®</option>
                <option value="å”®æœ">å”®æœ</option>`;
        }

        document.getElementById('card-service-item').classList.remove('hidden-field');
        renumberQuestions();
    }
    /**
    * å¼·åˆ¶æ¸…é™¤æ‰€æœ‰è¼¸å…¥æ¬„ä½çš„å€¼
    * @param {Array} excludeNames ä¸æƒ³è¦è¢«æ¸…é™¤çš„æ¬„ä½åç¨± (ä¾‹å¦‚ ['brand'])
    */
    function resetFormValues(excludeNames = []) {
        const allInputs = document.querySelectorAll('input, select, textarea');
        allInputs.forEach(input => {
            // å¦‚æœé€™å€‹æ¬„ä½åœ¨æ’é™¤æ¸…å–®å…§ï¼Œå°±ä¸å‹•å®ƒ
            if (excludeNames.includes(input.name)) return;

            if (input.type === 'radio' || input.type === 'checkbox') {
                input.checked = false;
            } else {
                input.value = '';
            }
        });
        
        // é¡å¤–é‡ç½®ä¸€äº›è‡ªå®šç¾©çš„ç‹€æ…‹ (å¦‚éš±è—çš„å­æ¬„ä½)
        document.getElementById('card-manual-input')?.classList.add('hidden-field');
        document.getElementById('card-waste-note')?.classList.add('hidden-field');
        document.getElementById('card-reduced-pressure')?.classList.add('hidden-field');
        document.getElementById('card-leak-reason')?.classList.add('hidden-field');
    }
    // æœå‹™é …ç›®é¸æ“‡è™•ç†
    function handleServiceItemChange() {
        const item = document.getElementById('service_item').value;
        if (!item) return;

        if (currentServiceItem && currentServiceItem !== item) {
            if (!confirm("è®Šæ›´æœå‹™é …ç›®å°‡æœƒé‡ç½®å¾ŒçºŒæ‰€æœ‰æ¬„ä½ï¼Œç¢ºå®šè¦è®Šæ›´å—ï¼Ÿ")) {
                document.getElementById('service_item').value = currentServiceItem;
                return;
            }
        }

        currentServiceItem = item;
        resetFormValues(['brand', 'service_item']); 
        currentServiceDetail = '';
        currentModel = '';
        hideAllCards(true); 

        const detailSelect = document.getElementById('service_detail');
        const detailCard = document.getElementById('card-service-detail');
        const modelSelect = document.getElementById('model'); // ç¢ºä¿é€™è£¡æœ‰ç²å–å…ƒä»¶
        const modelCard = document.getElementById('card-model');

        detailSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';
        modelSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>'; // ä¿®æ­£å®šç¾©å•é¡Œ

        if (currentBrand === 'åƒå±±') {
            if (item === 'è£æ©Ÿ') {
                detailSelect.innerHTML += '<option value="ä¸€èˆ¬è£æ©Ÿ">ä¸€èˆ¬è£æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="å…¨æˆ¶è£æ©Ÿ">å…¨æˆ¶è£æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            } else if (item === 'ç¶­ä¿®') {
                detailSelect.innerHTML += '<option value="ä¸€èˆ¬ç¶­ä¿®">ä¸€èˆ¬ç¶­ä¿®</option>';
                detailSelect.innerHTML += '<option value="å…¨æˆ¶ç¶­ä¿®">å…¨æˆ¶ç¶­ä¿®</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            } else if (item === 'å”®æœ') {
                detailSelect.innerHTML += '<option value="ä¸€èˆ¬å ´å‹˜">ä¸€èˆ¬å ´å‹˜</option>';
                detailSelect.innerHTML += '<option value="å…¨æˆ¶å ´å‹˜">å…¨æˆ¶å ´å‹˜</option>';
                detailSelect.innerHTML += '<option value="ç©ºå€¼">ç©ºå€¼(æ‰‹å‹•è¼¸å…¥)</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            } else if (item === 'åˆç´„') {
                detailSelect.innerHTML += '<option value="æ›æ¿¾èŠ¯">æ›æ¿¾èŠ¯</option>';
                detailSelect.innerHTML += '<option value="ç©ºå€¼">ç©ºå€¼(æ‰‹å‹•è¼¸å…¥)</option>';
                detailSelect.innerHTML += '<option value="å¤§ä¿æ‹†æ©Ÿ">å¤§ä¿æ‹†æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            }    
        } else if (currentBrand === 'æƒŸå“') {
            if (item === 'è£æ©Ÿ') {
                // æƒŸå“è£æ©Ÿ:å…ˆé¸æœå‹™ç´°é …
                detailSelect.innerHTML += '<option value="è£æ©Ÿ">è£æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="æ–°æ©Ÿç•°å¸¸">æ–°æ©Ÿç•°å¸¸</option>';
                detailSelect.innerHTML += '<option value="å‡ç´šè£æ©Ÿ">å‡ç´šè£æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            } else if (item === 'ç¶­ä¿®') {
                // æƒŸå“ç¶­ä¿®:å…ˆé¸æœå‹™ç´°é …
                detailSelect.innerHTML += '<option value="ç¶­ä¿®">ç¶­ä¿®</option>';
                detailSelect.innerHTML += '<option value="åº—ä¿®">åº—ä¿®</option>';                
                detailSelect.innerHTML += '<option value="æ‹–ä¿®">æ‹–ä¿®</option>';
                detailSelect.innerHTML += '<option value="æ›´æ›é¢æ¿">æ›´æ›é¢æ¿</option>';
                detailSelect.innerHTML += '<option value="æ›æ©Ÿ">æ›æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            } else if (item === 'å”®æœ') {
                // æƒŸå“å”®æœ:å…ˆé¸æœå‹™ç´°é …
                detailSelect.innerHTML += '<option value="æ›´æ›æ¿¾èŠ¯">æ›´æ›æ¿¾èŠ¯</option>';
                detailSelect.innerHTML += '<option value="æ‹†æ©Ÿ">æ‹†æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="é‡è£æ©Ÿ">é‡è£æ©Ÿ</option>';
                detailSelect.innerHTML += '<option value="æ‰‹å‹•è¼¸å…¥">æ‰‹å‹•è¼¸å…¥</option>';
                detailSelect.innerHTML += '<option value="å ´å‹˜">å ´å‹˜</option>';
                detailSelect.innerHTML += '<option value="å–æ¶ˆ">å–æ¶ˆ</option>';
                detailCard.classList.remove('hidden-field');
                modelCard.classList.add('hidden-field');
            }
        }
        
        renumberQuestions();
    }

    // æœå‹™ç´°é …é¸æ“‡è™•ç†
    function handleServiceDetailChange() {
        const detailValue = document.getElementById('service_detail').value;
        if (!detailValue) return;

        if (currentServiceDetail && currentServiceDetail !== detailValue) {
            resetFormValues(['brand', 'service_item', 'service_detail']);
            currentModel = ''; 
            hideAllCards(true); 
        }
        currentServiceDetail = detailValue;
        
        const modelCard = document.getElementById('card-model');
        const modelSelect = document.getElementById('model');
        const manualCard = document.getElementById('card-manual-input'); // æ–°å¢é€™è¡Œä¿®æ­£ ReferenceError

        modelSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';
        
        if (currentBrand === 'åƒå±±') {
                if (detailValue === 'å…¶ä»–' || detailValue === 'æ‰‹å‹•è¼¸å…¥'|| detailValue === 'ç©ºå€¼') { // å¢åŠ åˆ¤æ–·
                    if(manualCard) manualCard.classList.remove('hidden-field');
                } else {
                    if(manualCard) manualCard.classList.add('hidden-field');
                }
                showQianshanFields();
        } else if (currentBrand === 'æƒŸå“') {
            if(manualCard) manualCard.classList.add('hidden-field');
            
            // æ ¹æ“šæœå‹™é …ç›®å’Œæœå‹™ç´°é …é¡¯ç¤ºæ©Ÿå™¨å‹è™Ÿé¸é …
            modelSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';
            
            if (currentServiceItem === 'è£æ©Ÿ') {
                if (detailValue === 'è£æ©Ÿ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'æ–°æ©Ÿç•°å¸¸') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'å‡ç´šè£æ©Ÿ') {
                    modelSelect.innerHTML += '<option value="WD1â†’WD2">WD1â†’WD2</option>';
                    modelSelect.innerHTML += '<option value="WD1â†’WS2-C">WD1â†’WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1â†’WS2-H">WD1â†’WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WS1â†’WD2">WS1â†’WD2</option>';
                    modelSelect.innerHTML += '<option value="WS1â†’WS2-C">WS1â†’WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS1â†’WS2-H">WS1â†’WS2-H</option>';
                    modelCard.classList.remove('hidden-field');    
                } else if (detailValue === 'å–æ¶ˆ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelCard.classList.remove('hidden-field');
                }
            } else if (currentServiceItem === 'ç¶­ä¿®') {
                if (detailValue === 'ç¶­ä¿®') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'åº—ä¿®') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'æ‹–ä¿®') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';

                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'æ›´æ›é¢æ¿') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'æ›æ©Ÿ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelCard.classList.remove('hidden-field');
    
                } else if (detailValue === 'å–æ¶ˆ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                }
            } else if (currentServiceItem === 'å”®æœ') {
                if (detailValue === 'æ›´æ›æ¿¾èŠ¯') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'æ‹†æ©Ÿ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'é‡è£æ©Ÿ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'å ´å‹˜') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'æ‰‹å‹•è¼¸å…¥') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                } else if (detailValue === 'å–æ¶ˆ') {
                    modelSelect.innerHTML += '<option value="WS2-C">WS2-C</option>';
                    modelSelect.innerHTML += '<option value="WS2-H">WS2-H</option>';
                    modelSelect.innerHTML += '<option value="WD2-C">WD2-C</option>';
                    modelSelect.innerHTML += '<option value="WD1">WD1</option>';
                    modelSelect.innerHTML += '<option value="WS1">WS1</option>';
                    modelCard.classList.remove('hidden-field');
                }
            }
        }
        
        renumberQuestions();
    }

    // æ©Ÿå™¨å‹è™Ÿé¸æ“‡è™•ç†
    function handleModelChange() {
        const model = document.getElementById('model').value;
        if (!model) return;

        // å¦‚æœå‹è™Ÿæ”¹è®Šï¼Œé‡ç½®å‹è™Ÿä¹‹å¾Œçš„æ‰€æœ‰è¼¸å…¥æ¬„ä½
        if (currentModel && currentModel !== model) {
            // ä¿ç•™å‰ä¸‰å€‹éšå±¤ï¼Œå…¶é¤˜æ¸…é™¤
            resetFormValues(['brand', 'service_item', 'service_detail', 'model']);
            hideAllCards(true);
        }
        
        currentModel = model;
        
        // ==========================================
        // â˜… æ–°å¢é€™æ®µç¨‹å¼ç¢¼ï¼šè‡ªå‹•å¸¶å…¥æ©Ÿå™¨å‹è™Ÿé–‹é ­
        // ==========================================
        const machineModelInput = document.querySelector('input[name="machine_model"]');
        if (machineModelInput) {
            // å°‡é¸æ“‡çš„ value (å¦‚ WS2-C) ç›´æ¥å¡«å…¥æ©Ÿå™¨å‹è™Ÿæ¬„ä½
            machineModelInput.value = model; 
            
            // å¦‚æœæ‚¨å¸Œæœ›å¸¶å…¥å¾Œè‡ªå‹•åŠ ä¸€å€‹ç©ºæ ¼ï¼Œå¯ä»¥æ”¹æˆä¸‹é¢é€™è¡Œï¼š
            // machineModelInput.value = model + " "; 
        }
        // ==========================================

        if (currentBrand === 'æƒŸå“') {
            showWeipinFields();
        }
        
        renumberQuestions();
    }

    // é¡¯ç¤ºåƒå±±æ¬„ä½(ä¿æŒåŸæ¨£)
    function showQianshanFields() {
        hideAllCards(true);
        
        const item = currentServiceItem;
        const detail = currentServiceDetail;
        
        if (item === 'è£æ©Ÿ') {
            if (detail === 'ä¸€èˆ¬è£æ©Ÿ') {
                currentRequiredIds = [...qsInstallRequired];
                showCards([
                    'card-name', 'card-invoice-number', 'card-machine-serial','card-service-date', 'card-customer','card-customer-code', 'card-machine-type',                    
                    'card-faucet', 'card-site-voltage', 'card-waste-type','card-wp-customer',
                    'card-raw-pressure', 'card-raw-tds', 'card-leak-circuit','card-leak-reason',
                    'card-original-pressure','card-pressure-pump','card-drainage-type','card-countertop',
                    'card-taste','card-wp-note','card-principle','card-install-location',


                ]);
            } else if (detail === 'å…¨æˆ¶è£æ©Ÿ') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-invoice-number', 'card-machine-serial','card-service-date', 'card-customer',  'card-customer-code','card-machine-type',                      
                    'card-faucet', 'card-site-voltage', 'card-waste-type','card-install-location','card-install-floor','card-app',
                    'card-raw-pressure', 'card-leak-reason','card-wp-customer',
                    'card-pressure-pump','card-original-pressure',
                    'card-wp-note','card-principle',
                ]);
            }else if (detail === 'å–æ¶ˆ') {
                currentRequiredIds = [];
                showCards([
                    'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                ]);
            }
        } else if (item === 'ç¶­ä¿®') {
            if (detail === 'ä¸€èˆ¬ç¶­ä¿®') {
                currentRequiredIds = [...qsRepairRequired];
                showCards([
                    'card-name', 'card-invoice-number','card-machine-serial', 'card-service-date', 'card-customer','card-machine-serial' ,                    
                     'card-customer-code',  'card-wp-customer','card-original-pressure',
                    'card-raw-tds','card-site-voltage',
                    'card-repair-reason','card-actual-reason',
                    'card-leak-circuit','card-leak-reason','card-parts-payment',
                    'card-pressure-pump','card-drainage-type','card-taste','card-wp-note','card-handling',
                    'card-inspection-result','card-is-payment','card-machine-type',
                ]);
            } else if (detail === 'å…¨æˆ¶ç¶­ä¿®') {
                currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
                showCards([
                    'card-name', 'card-invoice-number','card-machine-serial', 'card-service-date', 'card-customer',' card-machine-serial' ,                        
                     'card-customer-code',  'card-wp-customer','card-app',                    
                    'card-repair-reason','card-actual-reason',
                    'card-leak-reason','card-parts-payment',
                    'card-pressure-pump','card-wp-note','card-handling',
                    'card-inspection-result','card-is-payment','card-machine-serial','card-machine-type',
                ]);
            } else if (detail === 'å–æ¶ˆ') {
                currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
                showCards([
                    'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name',
                ]);
            }
        }else if (item === 'å”®æœ') {
            if (detail === 'ä¸€èˆ¬å ´å‹˜') {
                currentRequiredIds = [...qsRepairRequired];
                showCards([
                    'card-name', 'card-invoice-number','card-machine-serial', 'card-service-date', 'card-customer',                     
                     'card-customer-code',  'card-wp-customer','card-original-pressure',
                    'card-raw-tds','card-site-voltage',
                    'card-replaced-parts','card-repair-reason','card-actual-reason',
                    'card-leak-circuit','card-leak-reason',
                    'card-pressure-pump','card-drainage-type','card-taste','card-wp-note','card-handling',
                    'card-inspection-result','card-is-payment','card-water-source','card-pump-photo',
                    'card-pipe-material','card-signal-strength','card-install-location','card-install-floor','card-countertop',
                ]);
            } else if (detail === 'å…¨æˆ¶å ´å‹˜') {
                currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
                showCards([
                    'card-name', 'card-invoice-number','card-machine-serial', 'card-service-date', 'card-customer',                     
                     'card-customer-code',  'card-wp-customer','card-original-pressure',
                    'card-site-voltage',
                    'card-replaced-parts','card-repair-reason','card-actual-reason',
                    'card-leak-circuit','card-leak-reason',
                    'card-pressure-pump','card-drainage-type','card-taste','card-wp-note','card-handling',
                    'card-inspection-result','card-is-payment','card-water-source','card-pump-photo',
                    'card-pipe-material','card-signal-strength','card-install-location','card-install-floor',
                    'card-pipe-spec','card-pipe-material','card-signal-strength',
                ]);

            } else if (detail === 'å–æ¶ˆ') {
                currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
                showCards([
                    'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                ]);
            } else if (detail === 'ç©ºå€¼') { 
            currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
            showCards([
                'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                'card-machine-type','card-machine-serial',
                // æ‚¨å¯ä»¥ä¾éœ€æ±‚åœ¨é€™è£¡åŠ å…¥æ›´å¤šæ¬„ä½ï¼Œä¾‹å¦‚ 'card-parts-payment' ç­‰
            ]);
            }
        }else if (item === 'åˆç´„') {
            if (detail === 'æ›æ¿¾èŠ¯') {
                currentRequiredIds = [...qsRepairRequired];
                showCards([
                'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                'card-machine-type','card-machine-serial',
                'card-raw-tds','card-taste','card-handling','card-inspection-result','card-replaced-parts','card-parts-payment','card-is-payment',
                ]);
            } else if (detail === 'å¤§ä¿æ‹†æ©Ÿ') {
                currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
                showCards([
                'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                'card-machine-type','card-machine-serial',
                ]);

            } else if (detail === 'å–æ¶ˆ') {
                currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
                showCards([
                    'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                ]);
            } else if (detail === 'ç©ºå€¼') { 
            currentRequiredIds = ['card-name', 'card-service-date', 'card-customer', 'card-phone'];
            showCards([
                'card-service-date','card-invoice-number','card-customer-code','card-wp-customer','card-wp-note','card-name','card-repair-reason','card-actual-reason',
                'card-machine-type','card-machine-serial',
                // æ‚¨å¯ä»¥ä¾éœ€æ±‚åœ¨é€™è£¡åŠ å…¥æ›´å¤šæ¬„ä½ï¼Œä¾‹å¦‚ 'card-parts-payment' ç­‰
            ]);
            }
        }
    }

    // é¡¯ç¤ºæƒŸå“æ¬„ä½(æ ¹æ“šéœ€æ±‚æ›´æ–°)
    function showWeipinFields() {
        hideAllCards(true);
        
        if (currentServiceItem === 'è£æ©Ÿ') {
            if (currentServiceDetail === 'æ–°æ©Ÿç•°å¸¸' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',
                    'card-machine-model-2', 'card-machine-serial-2', 'card-machine-type-2',
                    'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer',
                    'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 
                    'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'æ–°æ©Ÿç•°å¸¸' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',
                    'card-machine-model-2', 'card-machine-serial-2', 'card-machine-type-2',
                    'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer',
                    'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot',
                    'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'æ–°æ©Ÿç•°å¸¸' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',
                    'card-machine-model-2', 'card-machine-serial-2', 'card-machine-type-2',
                    'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-wp-customer',
                    'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power', 'card-power',
                    'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-app',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'è£æ©Ÿ' && currentModel === 'WS2-C') {
                currentRequiredIds = ['card-wp-customer'];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app', 'card-wp-note','card-original-pressure',
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'è£æ©Ÿ' && currentModel === 'WS2-H') {
                currentRequiredIds = ['card-wp-customer'];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-raw-tds', 
                    'card-env-temp', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot',, 'card-temp-group', 'card-raw-flow', 'card-raw-temp', 
                    'card-principle', 'card-taste', 'card-calibration',
                    'card-battery', 'card-app', 'card-wp-note','card-original-pressure','card-panel-voltage'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'è£æ©Ÿ' && currentModel === 'WD2-C') {
                currentRequiredIds = ['card-wp-customer'];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-æ˜¯å¦åŠ è£Filter-C',
                    'card-wp-customer', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-wp-note','card-original-pressure','card-app',
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
                        } else if (currentServiceDetail === 'å‡ç´šè£æ©Ÿ' && currentModel === 'WD1â†’WD2') {
                // å‡ç´šè£æ©Ÿ-WD1â†’WD2
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-model-2', 'card-machine-serial-2',
                    'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-customer-code',
                    'card-wp-customer', 'card-firmware-version',
                     'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-app', 'card-repair-reason',
                    'card-actual-reason', 'card-handling', 'card-inspection-result',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'å‡ç´šè£æ©Ÿ' && currentModel === 'WS1â†’WD2') {
                // å‡ç´šè£æ©Ÿ-WD1â†’WD2
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-model-2', 'card-machine-serial-2',
                    'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-customer-code',
                    'card-wp-customer', 'card-firmware-version',
                     'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-app', 'card-repair-reason',
                    'card-actual-reason', 'card-handling', 'card-inspection-result',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'å‡ç´šè£æ©Ÿ' && currentModel === 'WD1â†’WS2-C') {
                // å‡ç´šè£æ©Ÿ-WD1â†’WS2C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-model-2', 'card-machine-serial-2',
                    'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type',
                    'card-faucet-label', 'card-customer-code', 'card-wp-customer',
                    'card-panel-version', 'card-firmware-version', 
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-parts-payment', 'card-payment-detail',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'å‡ç´šè£æ©Ÿ' && currentModel === 'WS1â†’WS2-H') {
                // å‡ç´šè£æ©Ÿ-WD1â†’WS2H
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-model-2', 'card-machine-serial-2',
                    'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type',
                    'card-faucet-label', 'card-customer-code', 'card-wp-customer',
                    'card-panel-version', 'card-firmware-version', 
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-parts-payment', 'card-payment-detail',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'å‡ç´šè£æ©Ÿ' && currentModel === 'WS1â†’WS2-C') {
                // å‡ç´šè£æ©Ÿ-WD1â†’WS2-C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-model-2', 'card-machine-serial-2',
                    'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type',
                    'card-faucet-label', 'card-customer-code', 'card-wp-customer',
                    'card-panel-version', 'card-firmware-version', 
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-parts-payment', 'card-payment-detail',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'å‡ç´šè£æ©Ÿ' && currentModel === 'WD1â†’WS2-H') {
                // å‡ç´šè£æ©Ÿ-WD1â†’WS2-H
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-model-2', 'card-machine-serial-2',
                    'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type',
                    'card-faucet-label', 'card-customer-code', 'card-wp-customer',
                    'card-panel-version', 'card-firmware-version', 
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-parts-payment', 'card-payment-detail',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';    
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel ==='WS2-C') {
                currentRequiredIds = [];
                showCards(['card-service-date', 'card-invoice-number', 'card-customer-code', 'card-wp-customer', 'card-wp-note']);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards(['card-service-date', 'card-invoice-number', 'card-customer-code', 'card-wp-customer', 'card-wp-note']);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards(['card-service-date', 'card-invoice-number', 'card-customer-code', 'card-wp-customer', 'card-wp-note']);
            }
        } else if (currentServiceItem === 'ç¶­ä¿®') {
            if (currentServiceDetail === 'ç¶­ä¿®' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',                    
                    'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer',
                    'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 'card-principle',
                    'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'ç¶­ä¿®' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',                    
                    'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer',
                    'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot',,  'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'ç¶­ä¿®' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',                    
                    'card-æ˜¯å¦åŠ è£Filter-C','card-wp-customer', 'card-site-voltage', 'card-adjust-power', 'card-power',
                    'card-principle', 'card-taste', 'card-calibration','card-temp-group',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'ç¶­ä¿®' && currentModel === 'WD1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code','card-machine-serial',
                    'card-site-voltage', 'card-power', 'card-f11-flow','card-æ˜¯å¦åŠ è£Filter-C' ,'card-customer',
                    'card-hot-tank-output', 'card-normal-tank-output','card-firmware-version',
                    'card-ice-tank-output', 'card-ice-tank-cooling', 'card-taste',
                     'card-repair-reason', 'card-actual-reason','card-machine-type-repair',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts','card-temp-group-100',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note','card-machine-type'
                ]);
            } else if (currentServiceDetail === 'ç¶­ä¿®' && currentModel === 'WS1') {
                // ç¶­ä¿®-ç¶­ä¿®-WS1
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code','card-machine-serial',
                    'card-site-voltage', 'card-power', 'card-f11-flow','card-æ˜¯å¦åŠ è£Filter-C' ,'card-customer',
                    'card-hot-tank-output', 'card-normal-tank-output','card-firmware-version', 'card-taste',
                    'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts','card-temp-group-100',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note','card-machine-type',
                ]);
                // WS1åªé¡¯ç¤º100Â°Cå’Œ35Â°C
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';

                } else if (currentServiceDetail === 'æ›æ©Ÿ' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',
                    'card-machine-model-2', 'card-machine-serial-2', 'card-machine-type-2',
                    'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer',
                    'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 
                    'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'æ›æ©Ÿ' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',
                    'card-machine-model-2', 'card-machine-serial-2', 'card-machine-type-2',
                    'card-æ˜¯å¦åŠ è£Filter-C', 'card-faucet-type', 'card-faucet-label',
                    'card-wp-customer',
                    'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot',
                    'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'æ›æ©Ÿ' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-machine-model', 'card-machine-serial', 'card-machine-type','card-machine-type-repair',
                    'card-machine-model-2', 'card-machine-serial-2', 'card-machine-type-2',
                    'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-wp-customer',
                    'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power', 'card-power',
                    'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration', 'card-battery',
                    'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 
                     'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';         
                
            } else if (currentServiceDetail === 'åº—ä¿®' && currentModel === 'WS2-C') {
                // åº—ä¿®-WS2-C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'åº—ä¿®' && currentModel === 'WD2-C') {
                // åº—ä¿®-WD2-C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'åº—ä¿®' && currentModel === 'WD1') {
                // åº—ä¿®-WD1
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial',  'card-customer-code',
                    'card-wp-customer', 'card-firmware-version',
                    'card-temp-group', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note','card-f11-flow',
                    'card-hot-tank-output','card-normal-tank-output','card-ice-tank-output','card-ice-tank-cooling', 
                ]);
                document.getElementById('temp-100').style.display = 'flex';                
                // ğŸ‘‡ğŸ‘‡ ä¿®æ”¹é€™è£¡ï¼šæ”¹æˆ 'none' å°±æœƒéš±è—äº† ğŸ‘‡ğŸ‘‡
                document.getElementById('temp-35').style.display = 'none';                
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'åº—ä¿®' && currentModel === 'WS1') {
                // åº—ä¿®-WD1
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial',  'card-customer-code',
                    'card-wp-customer', 'card-firmware-version',
                    'card-temp-group', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note','card-f11-flow',
                    'card-hot-tank-output','card-normal-tank-output',
                ]);
                document.getElementById('temp-100').style.display = 'flex';                
                // ğŸ‘‡ğŸ‘‡ ä¿®æ”¹é€™è£¡ï¼šæ”¹æˆ 'none' å°±æœƒéš±è—äº† ğŸ‘‡ğŸ‘‡
                document.getElementById('temp-35').style.display = 'none';                
                document.getElementById('temp-10').style.display = 'none';                
            } else if (currentServiceDetail === 'åº—ä¿®' && currentModel === 'WS2-H') {
                // åº—ä¿®-WS2-H
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-repair-reason', 'card-actual-reason','card-power-hot',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'æ›´æ›é¢æ¿' && currentModel === 'WS2-C') {
                // æ›´æ›é¢æ¿-WS2-C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-panel-voltage', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-replaced-parts', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'æ›´æ›é¢æ¿' && currentModel === 'WS2-H') {
                // æ›´æ›é¢æ¿-WS2-H
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-panel-voltage', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-replaced-parts', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS2-C') {
                // å–æ¶ˆ-ALL
                currentRequiredIds = [];
                showCards([
                    'card-service-date', 'card-invoice-number', 'card-wp-customer','card-customer-code', 
                    'card-panel-version', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS2-H') {
                // å–æ¶ˆ-ALL
                currentRequiredIds = [];
                showCards([
                    'card-service-date', 'card-invoice-number', 'card-wp-customer','card-customer-code', 
                    'card-panel-version', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WD2-C') {
                // å–æ¶ˆ-ALL
                currentRequiredIds = [];
                showCards([
                    'card-service-date', 'card-invoice-number', 'card-wp-customer','card-customer-code', 
                    'card-panel-version', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WD1') {
                // å–æ¶ˆ-ALL
                currentRequiredIds = [];
                showCards([
                    'card-service-date', 'card-invoice-number', 'card-wp-customer','card-customer-code', 
                    'card-panel-version', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS1') {
                // å–æ¶ˆ-ALL
                currentRequiredIds = [];
                showCards([
                    'card-service-date', 'card-invoice-number', 'card-wp-customer','card-customer-code', 
                    'card-panel-version', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);

            } else if (currentServiceDetail === 'æ‹–ä¿®' && currentModel === 'WS2-C') {
                // æ‹–ä¿®-WS2-C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-type-repair', 'card-machine-model-2',
                    'card-machine-serial-2', 'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                     'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power', 'card-panel-voltage',
                    'card-raw-flow', 'card-raw-temp', 'card-principle',
                    'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'æ‹–ä¿®' && currentModel === 'WS2-H') {
                // æ‹–ä¿®-WS2-H
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-type-repair', 'card-machine-model-2',
                    'card-machine-serial-2', 'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                     'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power-hot', 'card-panel-voltage',
                    'card-raw-flow', 'card-raw-temp', 'card-principle',
                    'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'æ‹–ä¿®' && currentModel === 'WD2-C') {
                // æ‹–ä¿®-WD2-C
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-type-repair', 'card-machine-model-2',
                    'card-machine-serial-2', 'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-customer-code', 'card-wp-customer', 'card-firmware-version',
                     'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-app', 'card-repair-reason',
                    'card-actual-reason', 'card-handling', 'card-inspection-result',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'æ‹–ä¿®' && currentModel === 'WD1') {
                // æ‹–ä¿®-WD1
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-machine-type-repair', 'card-machine-model-2',
                    'card-machine-serial-2', 'card-machine-type-2', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-customer-code', 'card-wp-customer', 'card-firmware-version',
                     'card-temp-group', 'card-site-voltage',
                    'card-adjust-power', 'card-power', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-app', 'card-repair-reason',
                    'card-actual-reason', 'card-handling', 'card-inspection-result',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'æ‹–ä¿®' && currentModel === 'WS1') {
                // æ‹–ä¿®-WS1(æ–°å¢)
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-type',
                    'card-machine-serial', 'card-customer-code', 'card-wp-customer',
                    'card-firmware-version', 'card-temp-group', 'card-f11-flow',
                    'card-hot-tank-output', 'card-normal-tank-output','card-power-hot',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-replaced-parts', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } 
        } else if (currentServiceItem === 'å”®æœ') {
            // ========== å”®æœ â†’ æ›´æ›æ¿¾èŠ¯ ==========
            if (currentServiceDetail === 'æ›´æ›æ¿¾èŠ¯' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model','card-machine-type',  
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 'card-principle',
                    'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'æ›´æ›æ¿¾èŠ¯' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model','card-machine-type',  
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot', 'card-panel-voltage', 'card-principle',
                    'card-taste', 'card-calibration', 'card-battery',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'æ›´æ›æ¿¾èŠ¯' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model','card-machine-type',  
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-firmware-version', 'card-temp-group',
                    'card-site-voltage', 'card-adjust-power', 'card-power-hot',
                    'card-principle', 'card-taste', 'card-calibration',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            // ========== å”®æœ â†’ æ‹†æ©Ÿ ==========
            } else if (currentServiceDetail === 'æ‹†æ©Ÿ' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note','card-machine-type',
                ]);
            } else if (currentServiceDetail === 'æ‹†æ©Ÿ' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note','card-machine-type',
                ]);
            } else if (currentServiceDetail === 'æ‹†æ©Ÿ' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note','card-machine-type',
                ]);
            } else if (currentServiceDetail === 'æ‹†æ©Ÿ' && currentModel === 'WD1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note','card-machine-type',
                ]);
            } else if (currentServiceDetail === 'æ‹†æ©Ÿ' && currentModel === 'WS1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-parts-payment',
                    'card-payment-detail', 'card-wp-note','card-machine-type',
                ]);                                    
            // ========== å”®æœ â†’ é‡è£æ©Ÿ ==========
            } else if (currentServiceDetail === 'é‡è£æ©Ÿ' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-parts-payment', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'é‡è£æ©Ÿ' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-faucet-type', 'card-faucet-label', 'card-customer-code',
                    'card-wp-customer', 'card-panel-version', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power-hot', 'card-panel-voltage', 'card-raw-flow',
                    'card-raw-temp', 'card-principle', 'card-taste',
                    'card-calibration', 'card-battery', 'card-app',
                    'card-repair-reason', 'card-actual-reason', 'card-handling',
                    'card-inspection-result', 'card-parts-payment', 'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'none';
            } else if (currentServiceDetail === 'é‡è£æ©Ÿ' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-machine-type-repair', 'card-æ˜¯å¦åŠ è£Filter-C',
                    'card-customer-code', 'card-wp-customer', 'card-firmware-version',
                    'card-raw-tds',  'card-env-temp',
                    'card-temp-group', 'card-site-voltage', 'card-adjust-power',
                    'card-power', 'card-raw-flow', 'card-raw-temp',
                    'card-principle', 'card-taste', 'card-calibration',
                    'card-app', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-parts-payment',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'é‡è£æ©Ÿ' && currentModel === 'WD1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 
                    'card-machine-serial', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-customer-code',
                    'card-wp-customer', 'card-firmware-version',
                     'card-temp-group', 'card-f11-flow',
                    'card-hot-tank-output', 'card-normal-tank-output',
                    'card-ice-tank-output', 'card-ice-tank-cooling', 'card-taste',
                    'card-calibration', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-parts-payment',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            } else if (currentServiceDetail === 'é‡è£æ©Ÿ' && currentModel === 'WS1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-machine-model',
                    'card-machine-serial', 'card-æ˜¯å¦åŠ è£Filter-C', 'card-customer-code',
                    'card-wp-customer', 'card-firmware-version',
                     'card-temp-group', 'card-f11-flow',
                    'card-hot-tank-output', 'card-normal-tank-output',
                    'card-taste','card-calibration', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-parts-payment',
                    'card-wp-note'
                ]);
                document.getElementById('temp-100').style.display = 'flex';
                document.getElementById('temp-35').style.display = 'flex';
                document.getElementById('temp-10').style.display = 'flex';
            // ========== å”®æœ â†’ æ‰‹å‹•è¼¸å…¥ ==========
            } else if (currentServiceDetail === 'æ‰‹å‹•è¼¸å…¥' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'æ‰‹å‹•è¼¸å…¥' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'æ‰‹å‹•è¼¸å…¥' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'æ‰‹å‹•è¼¸å…¥' && currentModel === 'WD1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);
            } else if (currentServiceDetail === 'æ‰‹å‹•è¼¸å…¥' && currentModel === 'WS1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-handling', 'card-inspection-result', 'card-replaced-parts',
                    'card-parts-payment', 'card-payment-detail', 'card-wp-note'
                ]);                       
            // ========== å”®æœ â†’ å–æ¶ˆ ==========
            } else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WD1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å–æ¶ˆ' && currentModel === 'WS1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-repair-reason', 'card-actual-reason',
                    'card-wp-note'
                ]);
            // ========== å”®æœ â†’ å ´å‹˜ ==========
            } else if (currentServiceDetail === 'å ´å‹˜' && currentModel === 'WS2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 'card-raw-tds',
                    'card-site-voltage', 'card-countertop',
                    'card-wp-note',
                ]);
            }else if (currentServiceDetail === 'å ´å‹˜' && currentModel === 'WS2-H') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 
                    'card-raw-tds','card-site-voltage', 'card-countertop',
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å ´å‹˜' && currentModel === 'WD2-C') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 
                    'card-raw-tds','card-site-voltage', 'card-countertop',                    
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å ´å‹˜' && currentModel === 'WD1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 
                    'card-raw-tds','card-site-voltage', 'card-countertop',                    
                    'card-wp-note'
                ]);
            }else if (currentServiceDetail === 'å ´å‹˜' && currentModel === 'WS1') {
                currentRequiredIds = [];
                showCards([
                    'card-name', 'card-service-date', 'card-invoice-number', 'card-customer-code',
                    'card-wp-customer', 
                    'card-raw-tds','card-site-voltage', 'card-countertop',                    
                    'card-wp-note'
                ]);

                
            }
        }
    }

    // éš±è—æ‰€æœ‰å¡ç‰‡
    function hideAllCards(keepBase = false) {
        const allCards = document.querySelectorAll('.question-card');
        allCards.forEach(card => {
            // å¦‚æœ keepBase ç‚º trueï¼Œå‰‡ä¸éš±è—åŸºç¤éšå±¤
            if (keepBase) {
                const baseIds = ['card-brand', 'card-service-item', 'card-service-detail', 'card-model', 'card-manual-input'];
                if (baseIds.includes(card.id)) return;
            }
            card.classList.add('hidden-field');
        });
    }

    // é¡¯ç¤ºæŒ‡å®šå¡ç‰‡
    function showCards(ids) {
        ids.forEach(id => {
            const card = document.getElementById(id);
            if (card) card.classList.remove('hidden-field');
        });
    }
    // è™•ç†æ”¶æ¬¾å“é …é¡¯ç¤ºé‚è¼¯
    function handlePaymentVisibility() {
        const isPayment = document.getElementById('is_payment').value;
        const paymentDetailCard = document.getElementById('card-payment-detail');
        
        if (isPayment === 'æ˜¯') {
            paymentDetailCard.classList.remove('hidden-field');
        } else {
            paymentDetailCard.classList.add('hidden-field');
            // å¯é¸ï¼šåˆ‡æ›ç‚ºã€Œå¦ã€æ™‚è‡ªå‹•æ¸…ç©ºå·²å¡«å¯«çš„å“é …
            paymentDetailCard.querySelector('textarea').value = '';
        }
        renumberQuestions(); // é‡æ–°ç·¨è™Ÿ
    }




    // æ’å»¢æ°´å‹å¼è®Šæ›´è™•ç†
    function handleWasteTypeChange() {
        const waste = document.getElementById('waste_type').value;
        const noteCard = document.getElementById('card-waste-note');
        if (waste === 'å›æ¡¶') {
            noteCard.classList.remove('hidden-field');
        } else {
            noteCard.classList.add('hidden-field');
        }
        renumberQuestions();
    }

    // æ¸›å£“é–¥è®Šæ›´è™•ç†
    function handlePressureValveChange() {
        const valve = document.getElementById('pressure_valve').value;
        const reducedCard = document.getElementById('card-reduced-pressure');
        if (valve === 'æœ‰') {
            reducedCard.classList.remove('hidden-field');
        } else {
            reducedCard.classList.add('hidden-field');
        }
        renumberQuestions();
    }

    // æ¼æ°´æ–·è·¯å™¨è®Šæ›´è™•ç†
    function handleLeakCircuitChange() {
        const leak = document.getElementById('leak_circuit').value;
        const reasonCard = document.getElementById('card-leak-reason');
        if (leak === 'æœªå®‰è£') {
            reasonCard.classList.remove('hidden-field');
        } else {
            reasonCard.classList.add('hidden-field');
        }
        renumberQuestions();
    }

    // é‡æ–°ç·¨è™Ÿå•é¡Œ
    function renumberQuestions() {
        const cards = document.querySelectorAll('.question-card:not(.hidden-field)');
        let count = 1;
        let previousCardId = null;
        
        const item = document.getElementById('service_item').value;
        const isInstall = (item === 'è£æ©Ÿ');

        cards.forEach((card) => {
            const title = card.querySelector('.question-title');
            if (title) {
                let text = title.innerText.replace(/^[\d\.\-\s]+/, '').replace('*', '').trim();
                let isRequired = false;

                if (title.innerHTML.includes('required') || title.innerText.includes('*')) {
                    isRequired = true;
                }
                if (card.id === 'card-service-detail') isRequired = true;

                let htmlContent = "";
                if (card.id === 'card-service-detail') {
                    htmlContent = `1-1. ${text}`;
                } else if (card.id === 'card-manual-input' && previousCardId === 'card-service-detail') {
                    htmlContent = `1-2. ${text}`;
                } else if (card.id === 'card-waste-note' && previousCardId === 'card-waste-type') {
                    htmlContent = `${count - 1}-1. ${text}`;
                } else if (card.id === 'card-leak-reason' && previousCardId === 'card-leak-circuit') {
                    htmlContent = `${count - 1}-1. ${text}`;
                } else if (card.id === 'card-reduced-pressure' && previousCardId === 'card-raw-pressure') {
                    htmlContent = `${count - 1}-1. ${text}`;
                }else if (card.id === 'card-principle-reason' && previousCardId === 'card-principle') {
                    htmlContent = `${count - 1}-1. ${text}`;
                } else {
                    htmlContent = `${count}. ${text}`;
                    count++;
                }

                if (isRequired) {
                    htmlContent += ` <span class="required">*</span>`;
                }
                
                title.innerHTML = htmlContent;
                previousCardId = card.id;
            }
        });
    }

    // è¡¨å–®é©—è­‰
    function validateForm() {
        let isValid = true;
        let errors = [];
        clearErrors();

        const visibleCards = document.querySelectorAll('.question-card:not(.hidden-field)');
        visibleCards.forEach(card => {
            const title = card.querySelector('.question-title');
            if (title && (title.innerHTML.includes('required') || title.innerText.includes('*'))) {
                
                let hasValue = false;
                let inputs = card.querySelectorAll('input:not([type="radio"]), select, textarea');
                let radios = card.querySelectorAll('input[type="radio"]');
                
                const isStrictCard = ['card-temp-group', 'card-power', 'card-taste'].includes(card.id);

                if (isStrictCard) {
                    let allFilled = true;
                    inputs.forEach(input => {
                        const tempRow = input.closest('.temp-row');
                        if (tempRow && tempRow.style.display === 'none') {
                            return;
                        }
                        if (!input.value.trim()) allFilled = false;
                    });
                    hasValue = allFilled;
                } else {
                    if (inputs.length > 0) {
                        inputs.forEach(input => { if(input.value.trim()) hasValue = true; });
                    }
                    if (radios.length > 0) {
                        let radioChecked = false;
                        radios.forEach(r => { if(r.checked) radioChecked = true; });
                        if(radioChecked) hasValue = true; 
                    }
                }

                if (!hasValue) {
                    isValid = false;
                    card.classList.add('error-border');
                    inputs.forEach(i => i.classList.add('error-input'));
                    let errText = title.innerText.replace('*', '').trim();
                    errors.push(errText);
                }
            }
        });

        if (!isValid) alert("âš ï¸ è«‹å¡«å¯«ä»¥ä¸‹å¿…å¡«æ¬„ä½ï¼š\n\n" + errors.join('\n'));
        return isValid;
    }

    // æ¸…é™¤éŒ¯èª¤æ¨™è¨˜
    function clearErrors() {
        document.querySelectorAll('.error-border').forEach(el => el.classList.remove('error-border'));
        document.querySelectorAll('.error-input').forEach(el => el.classList.remove('error-input'));
    }

    // ç²å–è¡¨å–®è³‡æ–™
    function getFormData() {
        let data = {};
        // ç²å–æ‰€æœ‰ã€Œå¯è¦‹å¡ç‰‡ã€ä¸­çš„è¼¸å…¥é …
        const visibleCards = document.querySelectorAll('.question-card:not(.hidden-field)');
        
        visibleCards.forEach(card => {
            const inputs = card.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                if (!input.name) return;
                if (input.type === 'radio' && !input.checked) return;
                
                // å¦‚æœå¤šå€‹ input å…±ç”¨åŒä¸€å€‹ nameï¼Œå‰‡ä¸²æ¥å®ƒå€‘ (ä¾‹å¦‚ fw_1)
                if (data[input.name]) {
                    data[input.name] += " - " + input.value;
                } else {
                    data[input.name] = input.value;
                }
            });
        });
        
        // åŠ å…¥åŸºæœ¬è³‡è¨Š
        data['brand'] = document.querySelector('input[name="brand"]:checked')?.value || "";
        data['service_item'] = document.getElementById('service_item').value;
        data['service_detail'] = document.getElementById('service_detail').value;
        //data['model'] = document.getElementById('model').value;
        
        return data;
    }
    function handlePrincipleChange() {
    const explained = document.getElementById('principle_explained').value;
    const reasonCard = document.getElementById('card-principle-reason');
    
    if (explained === 'å¦') {
        reasonCard.classList.remove('hidden-field');
    } else {
        reasonCard.classList.add('hidden-field');
        // åˆ‡æ›å›ã€Œæ˜¯ã€æˆ–ã€Œè«‹é¸æ“‡ã€æ™‚ï¼Œæ¸…ç©ºå·²å¡«å¯«çš„åŸå› 
        reasonCard.querySelector('textarea').value = '';
    }
    renumberQuestions(); // é‡æ–°è§¸ç·¨è™Ÿ
}
    function formatCustomerCode(input) {
        let val = input.value.trim();
        if (!val) return;

        if (currentBrand === 'æƒŸå“') {
            // æƒŸå“é‚è¼¯ï¼š
            // 1. å…ˆæŠŠæ‰€æœ‰éæ•¸å­—çš„å­—å…ƒåˆªæ‰ (é€™æœƒæŠŠ W åˆªæ‰ï¼Œæ²’é—œä¿‚æˆ‘å€‘å¾Œé¢è£œ)
            let numericPart = val.replace(/\D/g, ''); 
            
            // 2. å¦‚æœåˆªå®Œé‚„æœ‰æ•¸å­—ï¼Œæˆ–æ˜¯åŸæœ¬å°±æ˜¯ W0000ï¼Œå°±å¹«å®ƒè£œæˆæ¨™æº–æ ¼å¼
            // é€™è£¡ç¶­æŒæ‚¨åŸæœ¬é‚è¼¯ï¼šW + 9ä½æ•¸å­— (å…±10ç¢¼)
            if (numericPart.length > 0) {
                input.value = 'W' + numericPart.padStart(9, '0');
            } else {
                // å¦‚æœåˆªå…‰å…‰æ²’å‰©åŠå€‹æ•¸å­—ï¼Œå°±å›å¾©é è¨­å€¼
                input.value = "W0000";
            }
        } else if (currentBrand === 'åƒå±±') {
            // åƒå±±é‚è¼¯ï¼š
            // 1. å¼·åˆ¶è½‰å¤§å¯« (a -> A)
            // 2. ä¸åˆªé™¤ä»»ä½•å­—ï¼Œä¿ç•™ A é–‹é ­
            input.value = val.toUpperCase();
        }
    }

    // è¤‡è£½LINEæ ¼å¼
    function copyForLine() {
        if (!validateForm()) return;
        
        let header = '';
        // ... (ä¿æŒåŸæœ‰çš„å“ç‰ŒæŠ¬é ­é‚è¼¯) ...
        if (currentBrand === 'åƒå±±') {
            const item = document.getElementById('service_item').value;
            const detailSelect = document.getElementById('service_detail');
            header = `ã€${currentBrand} ${item}å›å ±ã€‘`;
            if (detailSelect.value) header += ` - ${detailSelect.value}`;
        } else {
            header = `ã€${currentBrand} ${currentServiceItem}å›å ±ã€‘ - ${currentServiceDetail} - ${currentModel}`;
        }

        let text = header + "\n";
        const visibleCards = document.querySelectorAll('.question-card:not(.hidden-field)');
        
        visibleCards.forEach(card => {
            // è·³éå‰å¹¾å€‹åŸºç¤é¸æ“‡å¡ç‰‡ï¼Œé¿å…é‡è¤‡
            if (['card-brand', 'card-service-item', 'card-service-detail', 'card-model'].includes(card.id)) return;

            const titleEl = card.querySelector('.question-title');
            if (!titleEl) return;

            let label = titleEl.innerText.replace(/^[\d\.\-\s]+/, '').replace('*', '').trim();
            let value = "";

            // ç‰¹æ®Šè™•ç†ï¼šæº«åº¦èˆ‡æ°´é‡ (å·²æœ‰é‚è¼¯ï¼Œä¿ç•™ä¸¦å„ªåŒ–)
            if (card.id === 'card-temp-group' || card.id === 'card-temp-group-100') {
                let groupText = "";
                const rows = card.querySelectorAll('.temp-row');
                rows.forEach(row => {
                    if (row.style.display === 'none') return;
                    const rowLabel = row.querySelector('.temp-label').innerText;
                    const rowInputs = Array.from(row.querySelectorAll('input')).map(i => i.value).filter(v => v !== "");
                    if (rowInputs.length > 0) {
                        groupText += `\n   ${rowLabel}ï¼š${rowInputs.join(' / ')}`;
                    }
                });
                value = groupText;
            } 
            // é€šç”¨è™•ç†ï¼šè™•ç†æ‰€æœ‰åŒ…å«å¤šå€‹ input/select çš„å¡ç‰‡ (å¦‚éŸŒé«”ç‰ˆæœ¬ã€é›»å£“ã€æœ€å¤§åŠŸç‡)
            else {
                const allInputs = card.querySelectorAll('input:not([type="radio"]), select, textarea');
                const checkedRadio = card.querySelector('input[type="radio"]:checked');

                if (checkedRadio) {
                    value = checkedRadio.parentElement.innerText.trim();
                } else if (allInputs.length > 0) {
                    // å°‡åŒä¸€å€‹å¡ç‰‡å…§æ‰€æœ‰æœ‰å¡«å€¼çš„æ¡†æ¡†ç”¨ " - " é€£æ¥
                    const values = Array.from(allInputs)
                        .map(i => i.value.trim())
                        .filter(v => v !== ""); 
                    value = values.join(' - ');
                }
            }
            
            if (value) text += `${label}ï¼š${value}\n`;
        });

        // è¤‡è£½åˆ°å‰ªè²¼ç°¿é‚è¼¯...
        const textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('âœ… å·²è¤‡è£½ LINE æ ¼å¼å…§å®¹ï¼');
    }

    // ä¸Šå‚³åˆ°é›²ç«¯
    async function uploadToCloud() {
        if (!validateForm()) return; 
        const data = getFormData();
        const btn = document.getElementById('btn-upload');
        const originalText = btn.innerHTML;
        btn.disabled = true; 
        btn.innerHTML = "â³ ä¸Šå‚³ä¸­...";
        try {
            await fetch(CLOUD_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'text/plain' },
                body: JSON.stringify(data)
            });
            alert("âœ… ä¸Šå‚³æˆåŠŸï¼");
        } catch (e) {
            alert("âœ… ä¸Šå‚³æŒ‡ä»¤å·²ç™¼é€ (è‹¥ç„¡å ±éŒ¯å³æˆåŠŸ)");
            console.error(e);
        } finally {
            btn.disabled = false; 
            btn.innerHTML = originalText;
        }
    }
</script>

</body>
</html>